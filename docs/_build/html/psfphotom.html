<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>psfphotom module &mdash; alala  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="stack module" href="stack.html" />
    <link rel="prev" title="lightcurve module" href="lightcurve.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> alala
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">alala</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="alala.html">alala module</a></li>
<li class="toctree-l2"><a class="reference internal" href="apphotom.html">apphotom module</a></li>
<li class="toctree-l2"><a class="reference internal" href="lightcurve.html">lightcurve module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">psfphotom module</a></li>
<li class="toctree-l2"><a class="reference internal" href="stack.html">stack module</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">alala</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">alala</a></li>
      <li class="breadcrumb-item active">psfphotom module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/psfphotom.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-psfphotom">
<span id="psfphotom-module"></span><h1>psfphotom module<a class="headerlink" href="#module-psfphotom" title="Permalink to this heading"></a></h1>
<dl class="simple">
<dt>CONTENTS:</dt><dd><ul class="simple">
<li><p><a class="reference internal" href="#psfphotom.PSF_photometry" title="psfphotom.PSF_photometry"><code class="xref py py-func docutils literal notranslate"><span class="pre">PSF_photometry()</span></code></a>: Get the effective Point Spread Function (ePSF) of
an image, fit all (or as many as desired) stars in the image with the
ePSF, get instrumental magnitudes, and then crossmatch with external
catalogue to get <strong>calibrated</strong> magnitudes</p></li>
<li><p><a class="reference internal" href="#psfphotom.ePSF_FWHM" title="psfphotom.ePSF_FWHM"><code class="xref py py-func docutils literal notranslate"><span class="pre">ePSF_FWHM()</span></code></a>: Get the full width at half-max (FWHM) of an ePSF</p></li>
<li><p><a class="reference internal" href="#psfphotom.copy_zero_point" title="psfphotom.copy_zero_point"><code class="xref py py-func docutils literal notranslate"><span class="pre">copy_zero_point()</span></code></a>: Copy zero point headers from one image to
another</p></li>
</ul>
</dd>
<dt>NON-STANDARD PYTHON DEPENDENCIES:</dt><dd><ul class="simple">
<li><p><cite>astropy</cite></p></li>
<li><p><cite>photutils</cite></p></li>
<li><p><cite>astroquery</cite></p></li>
</ul>
</dd>
<dt>NON-PYTHON DEPENDENCIES:</dt><dd><ul class="simple">
<li><p><cite>astrometry.net</cite></p></li>
</ul>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="psfphotom.PSF_photometry">
<span class="sig-prename descclassname"><span class="pre">psfphotom.</span></span><span class="sig-name descname"><span class="pre">PSF_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nstars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elongation_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrom_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsources</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_ePSF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ePSF_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_ePSF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ePSF_plot_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_resids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resids_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_source_offs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_offs_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_field_offs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_offs_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_blur_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psfphotom.PSF_photometry" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_file</strong> (<em>str</em>) – Filename for <strong>background-subtracted</strong> image</p></li>
<li><p><strong>mask_file</strong> (<em>str, optional</em>) – Filename for a bad pixel mask (default None)</p></li>
<li><p><strong>nstars</strong> (<em>int, optional</em>) – Maximum number of stars to use in <strong>constructing</strong> the ePSF (default
40; set to None to impose no limit)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float, optional</em>) – Detection sigma to use in image segmentation (default 5.0)</p></li>
<li><p><strong>pixelmin</strong> (<em>int, optional</em>) – <em>Minimum</em> allowed number of pixels in isophotes to be used in
building the ePSF (default 20)</p></li>
<li><p><strong>elongation_lim</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed elongation of isophotes to used be in building the
ePSF (default 1.4)</p></li>
<li><p><strong>area_max</strong> (<em>float, optional</em>) – <em>Maximum</em> alllowed area for sources to be used in building the ePSF,
in square pixels (default 500)</p></li>
<li><p><strong>cutout</strong> (<em>int, optional</em>) – Size of cutout around each star, in pixels (default 35; <strong>must be
odd, will be rounded down if even</strong>)</p></li>
<li><p><strong>astrom_sigma</strong> (<em>float, optional</em>) – Sigma threshold for astrometry.net source detection image (default 5.0)</p></li>
<li><p><strong>psf_sigma</strong> (<em>float, optional</em>) – Sigma of the Gaussian PSF of the image to be used by
astrometry.net (default 5.0)</p></li>
<li><p><strong>alim</strong> (<em>int, optional</em>) – Maximum allowed source area, in pixels**2, beyond which sources will
be deblended in astrometry.net (default 10000)</p></li>
<li><p><strong>write_xy</strong> (<em>bool, optional</em>) – Keep the <cite>.xy.fits</cite> source list produced by astrometry.net? (default
False)</p></li>
<li><p><strong>nsources</strong> (<em>int, optional</em>) – Limit on number of sources to fit with ePSF for obtaining the zero
point (default None –&gt; impose no limit)</p></li>
<li><p><strong>cat_num</strong> (<em>str, optional</em>) – Vizier catalog number to determine which catalog to cross-match (
default None –&gt; set to PanStarrs 1, SDSS DR12, or 2MASS depending on
filter used during observations)</p></li>
<li><p><strong>sep_max</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed separation between sources when cross-matching to
catalog, in pixels (default 2.0 ~ 0.6 arcseconds for WIRCam, 0.37
arcseconds for MegaCam)</p></li>
<li><p><strong>write_ePSF</strong> (<em>bool, optional</em>) – Write the derived ePSF to a .fits file? (default False)</p></li>
<li><p><strong>output_ePSF</strong> (<em>str, optional</em>) – Filename for output ePSF fits file (default None –&gt; set by function)</p></li>
<li><p><strong>plot_ePSF</strong> (<em>bool, optional</em>) – Plot the ePSF? (default True)</p></li>
<li><p><strong>ePSF_plot_output</strong> (<em>str, optional</em>) – Filename for output ePSF plot (default None –&gt; set by function)</p></li>
<li><p><strong>plot_resids</strong> (<em>bool, optional</em>) – Plot the residuals of the iterative ePSF fitting? (default False)</p></li>
<li><p><strong>resids_output</strong> (<em>str, optional</em>) – Filename for output residuals plot (default None –&gt; set by function)</p></li>
<li><p><strong>plot_corr</strong> (<em>bool, optional</em>) – Plot the instrumental magnitude versus castalogue magnitude
correlation used to obtain the zero point (default False)</p></li>
<li><p><strong>corr_output</strong> (<em>str, optional</em>) – Filename for output correlation plot (default None –&gt; set by function)</p></li>
<li><p><strong>plot_source_offs</strong> (<em>bool, optional</em>) – Plot offsets between image WCS and catalog WCS (default False)</p></li>
<li><p><strong>source_offs_output</strong> (<em>str, optional</em>) – Filename for output source offsets plot (default None –&gt; set by
function)</p></li>
<li><p><strong>plot_field_offs</strong> (<em>bool, optional</em>) – Plot offsets across the field, with a Gaussian blur to visualize
large-scale structure in the offsets, if any</p></li>
<li><p><strong>field_offs_output</strong> (<em>str, optional</em>) – Filename for output field offsets plot (default None –&gt; set by
function)</p></li>
<li><p><strong>gaussian_blur_sigma</strong> (<em>float, optional</em>) – Sigma of the Gaussian blur to use in the field offsets plot, if
plotting (default 30.0)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Write the table of calibrated sources with PSF photometry to a file?
(default False)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output fits table of sources (default None –&gt; set by
function)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Table of all PSF-fit sources, with their calibrated magnitudes</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Using image segmentation, find as many sources as possible in the image
with some constraints on number of pixels, elongation, and area. Use these
sources to build an empirical effective PSF (ePSF). Use a list of sources
found by astrometry.net to fit the ePSF to all of those sources. Compute
the instrumental magnitude of all of these sources. Query the correct
online catalogue for the given filter to crossmatch sources in the image
with those in the catalogue (e.g., Pan-STARRS 1). Find the zero point
which satisfies AB_mag = ZP + instrumental_mag and gets the calibrated
AB mags for all PSF-fit sources.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="psfphotom.ePSF_FWHM">
<span class="sig-prename descclassname"><span class="pre">psfphotom.</span></span><span class="sig-name descname"><span class="pre">ePSF_FWHM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsf_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psfphotom.ePSF_FWHM" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the full width at half-max (FWHM) of an ePSF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>epsf_data</strong> (<em>str, np.ndarray</em>) – Fits file containing ePSF data <strong>or</strong> the data array itself</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>FWHM of the ePSF</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="psfphotom.copy_zero_point">
<span class="sig-prename descclassname"><span class="pre">psfphotom.</span></span><span class="sig-name descname"><span class="pre">copy_zero_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#psfphotom.copy_zero_point" title="Permalink to this definition"></a></dt>
<dd><p>Copy the zero point headers from <cite>source_file</cite> to <cite>target_file</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>zp_mean</strong> (<em>float</em>) – Zero points mean</p></li>
<li><p><strong>zp_med</strong> (<em>float</em>) – Zero points median</p></li>
<li><p><strong>zp_std</strong> (<em>float</em>) – Zero points standard deviation</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Copy the zero point obtained via PSF photometry from one fits header to
another. Useful when one uses a background-subtracted image to do <em>PSF
photometry</em>, obtains the zero point, and then wants to perform <em>aperture
photometry</em> on the original, unsubtracted image.</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="lightcurve.html" class="btn btn-neutral float-left" title="lightcurve module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="stack.html" class="btn btn-neutral float-right" title="stack module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Nicholas Vieira.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
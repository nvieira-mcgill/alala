<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>alala package &mdash; alala 0.1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="alala" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> alala
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">alala</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">alala package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-alala.alala">alala.alala module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-alala.apphotom">alala.apphotom module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-alala.lightcurve">alala.lightcurve module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-alala.psfphotom">alala.psfphotom module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#alala-stack-module">alala.stack module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-alala">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">alala</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">alala</a></li>
      <li class="breadcrumb-item active">alala package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/alala.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="alala-package">
<h1>alala package<a class="headerlink" href="#alala-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-alala.alala">
<span id="alala-alala-module"></span><h2>alala.alala module<a class="headerlink" href="#module-alala.alala" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>SECTIONS:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt><a class="reference internal" href="#alala.alala.RawData" title="alala.alala.RawData"><code class="xref py py-class docutils literal notranslate"><span class="pre">RawData</span></code></a></dt><dd><ul>
<li><p>Initialization; basic functions</p></li>
<li><p>Image diagnostics + pre-solving before stacking</p></li>
<li><p>Locating coordinates among raw data + writing extensions</p></li>
<li><p>Combining/dividing (WIRCam) cubes</p></li>
<li><p>Cropping images</p></li>
<li><p>Stacking (co-adding images)</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="#alala.alala.Stack" title="alala.alala.Stack"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stack</span></code></a></dt><dd><ul>
<li><p>Bad pixel masks / source masks / error arrays</p></li>
<li><p>Making images (plots)</p></li>
<li><p>Astrometry</p></li>
<li><p>PSF photometry</p></li>
<li><p>Aperture photometry</p></li>
<li><p>PSF/aperture photometry comparison</p></li>
<li><p>Source selection</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<dl class="py exception">
<dt class="sig sig-object py" id="alala.alala.NoDataError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">alala.alala.</span></span><span class="sig-name descname"><span class="pre">NoDataError</span></span><a class="headerlink" href="#alala.alala.NoDataError" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Raise this error when a RawData object has no data.</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="alala.alala.TooFewMatchesError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">alala.alala.</span></span><span class="sig-name descname"><span class="pre">TooFewMatchesError</span></span><a class="headerlink" href="#alala.alala.TooFewMatchesError" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Raise this error when, during PSF photometry, the no. of sources in the
image which match those in some external catalogue is less than 3.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="alala.alala.VALID_DATA_EXT">
<span class="sig-prename descclassname"><span class="pre">alala.alala.</span></span><span class="sig-name descname"><span class="pre">VALID_DATA_EXT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('fits',</span> <span class="pre">'fits.fz',</span> <span class="pre">'flt')</span></em><a class="headerlink" href="#alala.alala.VALID_DATA_EXT" title="Permalink to this definition"></a></dt>
<dd><p>Valid file types for the image data.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="alala.alala.VALID_PLOT_EXT">
<span class="sig-prename descclassname"><span class="pre">alala.alala.</span></span><span class="sig-name descname"><span class="pre">VALID_PLOT_EXT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">('pdf',</span> <span class="pre">'jpg',</span> <span class="pre">'bmp',</span> <span class="pre">'png')</span></em><a class="headerlink" href="#alala.alala.VALID_PLOT_EXT" title="Permalink to this definition"></a></dt>
<dd><p>Valid file types for any plots which are produced.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="alala.alala.RawData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">alala.alala.</span></span><span class="sig-name descname"><span class="pre">RawData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qso_grade_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fits'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.data_dir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_dir</span></span><a class="headerlink" href="#alala.alala.RawData.data_dir" title="Permalink to this definition"></a></dt>
<dd><p>Directory containing the raw data</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.stack_dir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stack_dir</span></span><a class="headerlink" href="#alala.alala.RawData.stack_dir" title="Permalink to this definition"></a></dt>
<dd><p>Directory in which to store stacked images, if stacking</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.fmt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">fmt</span></span><a class="headerlink" href="#alala.alala.RawData.fmt" title="Permalink to this definition"></a></dt>
<dd><p>Format (file type/extension) of the data files</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.files">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">files</span></span><a class="headerlink" href="#alala.alala.RawData.files" title="Permalink to this definition"></a></dt>
<dd><p>All of the data files</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.plot_ext">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plot_ext</span></span><a class="headerlink" href="#alala.alala.RawData.plot_ext" title="Permalink to this definition"></a></dt>
<dd><p>Format (file type/extension) of any plots made/to be made</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.instrument">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">instrument</span></span><a class="headerlink" href="#alala.alala.RawData.instrument" title="Permalink to this definition"></a></dt>
<dd><p>Instrument (WIRCam, MegaCam, or MegaPrime) used to acquire data</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.nextend">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nextend</span></span><a class="headerlink" href="#alala.alala.RawData.nextend" title="Permalink to this definition"></a></dt>
<dd><p>Number of extensions in the image data files</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.qso_grade_limit">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">qso_grade_limit</span></span><a class="headerlink" href="#alala.alala.RawData.qso_grade_limit" title="Permalink to this definition"></a></dt>
<dd><p>Queue Service Observer (QSO) grade limit; only relevant if using
WIRCam data</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.date">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">date</span></span><a class="headerlink" href="#alala.alala.RawData.date" title="Permalink to this definition"></a></dt>
<dd><p>Date (YYYYMMDD) <strong>at the start</strong> of observations</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.mjdate">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mjdate</span></span><a class="headerlink" href="#alala.alala.RawData.mjdate" title="Permalink to this definition"></a></dt>
<dd><p>Modified Julian Date (MJD) <strong>at the start</strong> of observations</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.dates">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dates</span></span><a class="headerlink" href="#alala.alala.RawData.dates" title="Permalink to this definition"></a></dt>
<dd><p>All date(s) (YYYYMMDD) spanned by the data</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.dates_dict">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dates_dict</span></span><a class="headerlink" href="#alala.alala.RawData.dates_dict" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary with entries <cite>{date –&gt; [file1,file2,…]}</cite>, e.g.,
‘20190816’ –&gt; [‘file1’,’file2’,’file3’]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.filters">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">filters</span></span><a class="headerlink" href="#alala.alala.RawData.filters" title="Permalink to this definition"></a></dt>
<dd><p>Filters (bands) used in the observations which make up the data</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.filters_dict">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">filters_dict</span></span><a class="headerlink" href="#alala.alala.RawData.filters_dict" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary with entries <cite>{filter –&gt; [file1,file2,…]}</cite>, e.g.,
‘i’ –&gt; [‘file1’,’file2’,’file3’]</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.J">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">J</span></span><a class="headerlink" href="#alala.alala.RawData.J" title="Permalink to this definition"></a></dt>
<dd><p>Filenames for images acquired in the J-band</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.H">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">H</span></span><a class="headerlink" href="#alala.alala.RawData.H" title="Permalink to this definition"></a></dt>
<dd><p>Filenames for images acquired in the H-band</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.Ks">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Ks</span></span><a class="headerlink" href="#alala.alala.RawData.Ks" title="Permalink to this definition"></a></dt>
<dd><p>Filenames for images acquired in the Ks-band</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.Y">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Y</span></span><a class="headerlink" href="#alala.alala.RawData.Y" title="Permalink to this definition"></a></dt>
<dd><p>Filenames for images acquired in the Y-band</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.u">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">u</span></span><a class="headerlink" href="#alala.alala.RawData.u" title="Permalink to this definition"></a></dt>
<dd><p>Filenames for images acquired in the u-band</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.g">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">g</span></span><a class="headerlink" href="#alala.alala.RawData.g" title="Permalink to this definition"></a></dt>
<dd><p>Filenames for images acquired in the g-band</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.r">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">r</span></span><a class="headerlink" href="#alala.alala.RawData.r" title="Permalink to this definition"></a></dt>
<dd><p>Filenames for images acquired in the r-band</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.i">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">i</span></span><a class="headerlink" href="#alala.alala.RawData.i" title="Permalink to this definition"></a></dt>
<dd><p>Filenames for images acquired in the i-band</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.z">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">z</span></span><a class="headerlink" href="#alala.alala.RawData.z" title="Permalink to this definition"></a></dt>
<dd><p>Filenames for images acquired in the z-band</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.uS">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">uS</span></span><a class="headerlink" href="#alala.alala.RawData.uS" title="Permalink to this definition"></a></dt>
<dd><p>Filenames for images acquired in the uS-band</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.gS">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gS</span></span><a class="headerlink" href="#alala.alala.RawData.gS" title="Permalink to this definition"></a></dt>
<dd><p>Filenames for images acquired in the gS-band</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.rS">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rS</span></span><a class="headerlink" href="#alala.alala.RawData.rS" title="Permalink to this definition"></a></dt>
<dd><p>Filenames for images acquired in the rS-band</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.iS">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">iS</span></span><a class="headerlink" href="#alala.alala.RawData.iS" title="Permalink to this definition"></a></dt>
<dd><p>Filenames for images acquired in the iS-band</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.zS">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">zS</span></span><a class="headerlink" href="#alala.alala.RawData.zS" title="Permalink to this definition"></a></dt>
<dd><p>Filenames for images acquired in the zS-band</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.RawData.stack_made">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stack_made</span></span><a class="headerlink" href="#alala.alala.RawData.stack_made" title="Permalink to this definition"></a></dt>
<dd><p>Whether a stack has already been made for the object</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.set_stack_dir">
<span class="sig-name descname"><span class="pre">set_stack_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stack_dir</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.set_stack_dir" title="Permalink to this definition"></a></dt>
<dd><p>Set the name of the directory in which to store any stacked
images.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.set_plot_ext">
<span class="sig-name descname"><span class="pre">set_plot_ext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plot_ext</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.set_plot_ext" title="Permalink to this definition"></a></dt>
<dd><p>Set the file extension of any plots which are produced.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.exclude_date">
<span class="sig-name descname"><span class="pre">exclude_date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.exclude_date" title="Permalink to this definition"></a></dt>
<dd><p>Exclude a specific date from the data, by parsing through the image
files’ fits headers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>date</strong> (<em>str</em>) – A date of the format ‘YYYYMMDD’ or ‘YYYYMM’ or ‘YYYY’ to exclude
from the raw data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.exclude_object">
<span class="sig-name descname"><span class="pre">exclude_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.exclude_object" title="Permalink to this definition"></a></dt>
<dd><p>Exclude a specific target object from the data, by parsing through
the image files’ fits headers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obj</strong> (<em>str</em>) – Name of a target object to exclude, e.g., ‘NGC457’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.only_date">
<span class="sig-name descname"><span class="pre">only_date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.only_date" title="Permalink to this definition"></a></dt>
<dd><p>Exclude <strong>all but one</strong> specific date in the data, by parsing
through the image files’ fits headers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>date</strong> (<em>str</em>) – A date of the format ‘YYYYMMDD’ or ‘YYYYMM’ or ‘YYYY’ to select in
the raw data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.only_object">
<span class="sig-name descname"><span class="pre">only_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.only_object" title="Permalink to this definition"></a></dt>
<dd><p>Excude <strong>all but one</strong> specific target object in the data to be used by
parsing through the image files’ fits headers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obj</strong> (<em>str</em>) – Name of the object, e.g., ‘NGC457’</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.copy" title="Permalink to this definition"></a></dt>
<dd><p>Produces a (deep) copy of the object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.print_headers">
<span class="sig-name descname"><span class="pre">print_headers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ext</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">headers</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.print_headers" title="Permalink to this definition"></a></dt>
<dd><p>Print particular fits header(s) for data files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ext</strong> (<em>{‘fits’, ‘fits.fz’, ‘flt’}</em>) – Extension of interest for the image data to be parsed</p></li>
<li><p><strong>headers</strong> (<em>str</em>) – Name(s) of any header(s) of interest</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.value_at">
<span class="sig-name descname"><span class="pre">value_at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.value_at" title="Permalink to this definition"></a></dt>
<dd><p>Get the value at some RA and Dec, for all images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ra, dec</strong> (<em>float</em>) – Right Ascension (RA) and Declination of interest</p>
</dd>
</dl>
<p>For all of the files contained in the RawData object, prints the ADU
value at the given RA and Dec, <strong>if</strong> these coordinates are within the
image’s bounds. Can be used to see if, e.g., the ADU was set to 0
over a source of interest during image de-trending.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.background">
<span class="sig-name descname"><span class="pre">background</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.background" title="Permalink to this definition"></a></dt>
<dd><p>Estimate the background of the images.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List containing the background level of each file</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p>Naively estimates the background as the median of the image’s ADU
for every raw image in order to see how the data varies.</p>
<p class="rubric">Notes</p>
<p>Does not mask sources, but this is not important for the purpose of
this function: to see if any data is dubious</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.radial_PSFs">
<span class="sig-name descname"><span class="pre">radial_PSFs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solved</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adu_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adu_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">66000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.radial_PSFs" title="Permalink to this definition"></a></dt>
<dd><p>Produce radial PSFs for all images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – Right Ascension (RA) and Declination of interest</p></li>
<li><p><strong>solved</strong> (<em>bool, optional</em>) – Have the images already been solved with astrometry? (default
True)</p></li>
<li><p><strong>adu_min, adu_max</strong> (<em>float, optional</em>) – Minimum and maximum allowed ADU in the image (default 4000, 66000)</p></li>
</ul>
</dd>
</dl>
<p>For all of the files in the raw data directory, produces and saves a
figure of the radial profile around the input RA and Dec. If
<cite>solved=False</cite>, first solves the image with astrometry.net. (A refined
astrometric solution is required to get an accurate radial profile.) A
crude technique for estimating the PSF of an image.</p>
<p class="rubric">Notes</p>
<p>Best to pick a source which is bright, but not one which saturates the
detectors.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.solve_all">
<span class="sig-name descname"><span class="pre">solve_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">solved_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.solve_all" title="Permalink to this definition"></a></dt>
<dd><p>Find the astrometric solution for all images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>solved_dir</strong> (<em>str, optional</em>) – Directory in which to store the solved images (default None –&gt;
set automatically)</p></li>
<li><p><strong>depth</strong> (<em>int, optional</em>) – Number of stars to use in solving with astrometry.net, e.g.,
<cite>depth=100</cite> will use only the 100 brightest stars (default None
–&gt; no limit, use all stars)</p></li>
</ul>
</dd>
</dl>
<p>Using astrometry.net, solve all files, and put them in a new directory.
This is necessary when the astrometric solution obtained by CFHT is
inaccurate and requires refining, or if you wish to plot the radial
PSFs of some point in the raw data images.</p>
<p class="rubric">Notes</p>
<p>For MegaCam images, detectors <strong>(0, 1, …, 17)</strong>, <strong>36</strong>, <strong>37</strong>
(top half of camera) are oriented with North <strong>ANTI</strong>-parallel to the
y-axis and East parallel to the x-axis. Detectors
<strong>(18, 19, …, 35)</strong>, <strong>38</strong>, <strong>39</strong> (bottom half of the camera) are
oriented with North parallel to the y-axis and East <strong>ANTI</strong>-parallel
to the x-axis. When trying to make a stack from images in both the top
and bottom halves, IRAF sometimes gets confused.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.WCS_check">
<span class="sig-name descname"><span class="pre">WCS_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkall</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.WCS_check" title="Permalink to this definition"></a></dt>
<dd><p>Check if the input coordinates are spanned by any of the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – Right Ascension (RA) and Declination of interest</p></li>
<li><p><strong>frac</strong> (<em>float, optional</em>) – Fraction of the image to consider valid, e.g., 0.9 will
exclude the outermost 10% of the image (default 1.0 –&gt; whole
image)</p></li>
<li><p><strong>verbose</strong> (<em>bool, optional</em>) – Print lots of details? (default True)</p></li>
<li><p><strong>checkall</strong> (<em>bool, optional</em>) – Check all files, or, just return the first matching file?
(default True –&gt; check all files)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of files which span the given coordinates</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.locate_WCS">
<span class="sig-name descname"><span class="pre">locate_WCS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.locate_WCS" title="Permalink to this definition"></a></dt>
<dd><p>Given some coordinates and a multi-detector image, find the number
ID of the detector where the coordinates are located.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – Right Ascension (RA) and Declination of interest</p></li>
<li><p><strong>frac</strong> (<em>float, optional</em>) – Fraction of the image to consider valid, e.g., 0.9 will
exclude the outermost 10% of the image (default 1.0 –&gt; whole
image)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number ID of the detector where the coordinates are located</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.write_extensions">
<span class="sig-name descname"><span class="pre">write_extensions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_ext</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exten_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.write_extensions" title="Permalink to this definition"></a></dt>
<dd><p>Write a specific extension of each multi-header fits file to
individual files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_ext</strong> (<em>int</em>) – Extension number of interest (should be at least 1, n_ext=1 –&gt;
extract the 1st extension in the file which corresponds to the 0th
detector/CCD)</p></li>
<li><p><strong>exten_dir</strong> (<em>str, optional</em>) – Name for the directory which will hold the written extensions
(default None –&gt; set automatically)</p></li>
</ul>
</dd>
</dl>
<p>Gets the header and image data for the given extension and writes them
to a new .fits file. Does so for all raw data files. Stores them in a
new subdirectory. Used to extract image data for one of many CCDs /
detectors on either MegaPrime/WIRCam.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>For a given dataset, once <a class="reference internal" href="#alala.alala.RawData.locate_WCS" title="alala.alala.RawData.locate_WCS"><code class="xref py py-func docutils literal notranslate"><span class="pre">RawData.locate_WCS()</span></code></a> has been used
to find the extension containing the WCS of interest, run this
function once to extract that specific extension. Can then use this
newly made folder for stacking.</p></li>
<li><p>If the extensions are themselves cubes (sometimes the case for
WIRCam), see <a class="reference internal" href="#alala.alala.RawData.combine_WIRCam" title="alala.alala.RawData.combine_WIRCam"><code class="xref py py-func docutils literal notranslate"><span class="pre">RawData.combine_WIRCam()</span></code></a> or
<a class="reference internal" href="#alala.alala.RawData.divide_WIRCam" title="alala.alala.RawData.divide_WIRCam"><code class="xref py py-func docutils literal notranslate"><span class="pre">RawData.divide_WIRCam()</span></code></a>.</p></li>
<li><p>Currently only works for cubes of the form fits.fz, and produces
files of form fits.</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.write_extensions_all">
<span class="sig-name descname"><span class="pre">write_extensions_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_exten_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.write_extensions_all" title="Permalink to this definition"></a></dt>
<dd><p>Write each extension of each multi-header fits file to individual
files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>all_exten_dir</strong> (<em>str, optional</em>) – Name for the directory which will hold the written extensions
(default None –&gt; set automatically)</p>
</dd>
</dl>
<p>Gets the header and image data for <strong>all</strong> extensions of a
multi-header fits file and writes each extension to a new .fits file.
Useful for MegaPrime data where the scope moves a lot and the
detectors are all calibrated to the same ADU level.</p>
<p class="rubric">Notes</p>
<p>Currently only works for cubes of the form fits.fz, and produces
files of form fits.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.write_extensions_by_WCS">
<span class="sig-name descname"><span class="pre">write_extensions_by_WCS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wcs_exten_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.write_extensions_by_WCS" title="Permalink to this definition"></a></dt>
<dd><p>Same as <a class="reference internal" href="#alala.alala.RawData.write_extensions" title="alala.alala.RawData.write_extensions"><code class="xref py py-func docutils literal notranslate"><span class="pre">RawData.write_extensions()</span></code></a>, but select the
extension using an RA and Dec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – Right Ascension (RA) and Declination of interest</p></li>
<li><p><strong>frac</strong> (<em>float, optional</em>) – Fraction of the image to consider valid, e.g., 0.9 will
exclude the outermost 10% of the image (default 1.0 –&gt; whole
image)</p></li>
<li><p><strong>wcs_exten_dir</strong> (<em>str, optional</em>) – Name for the directory which will hold the written extensions
(default None –&gt; set automatically)</p></li>
</ul>
</dd>
</dl>
<p>For a directory full of multi-extension fits files, gets the extensions
which contain the input RA, Dec and writes them to a new file.</p>
<p class="rubric">Notes</p>
<p>Currently only works for cubes of the form fits.fz, and produces files
of form fits.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.write_source">
<span class="sig-name descname"><span class="pre">write_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.write_source" title="Permalink to this definition"></a></dt>
<dd><p>Same as <a class="reference internal" href="#alala.alala.RawData.write_extensions_by_WCS" title="alala.alala.RawData.write_extensions_by_WCS"><code class="xref py py-func docutils literal notranslate"><span class="pre">RawData.write_extensions_by_WCS()</span></code></a>, but write the
files to a new directory with name <cite>name</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Name of the source of interest (e.g. some transient)</p></li>
<li><p><strong>ra, dec</strong> (<em>float</em>) – Right Ascension (RA) and Declination of interest</p></li>
<li><p><strong>frac</strong> (<em>float, optional</em>) – Fraction of the image to consider valid, e.g., 0.9 will
exclude the outermost 10% of the image (default 1.0 –&gt; whole
image)</p></li>
</ul>
</dd>
</dl>
<p>Parses all raw data and copies any images which contain the input RA,
Dec to a new sub-directory with the name of the source.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.combine_WIRCam">
<span class="sig-name descname"><span class="pre">combine_WIRCam</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.combine_WIRCam" title="Permalink to this definition"></a></dt>
<dd><p>For a directory full of WIRCam images, if the images are cubes,
<strong>combine</strong> the multiple 2D arrays into single arrays.</p>
<p class="rubric">Notes</p>
<p>Use this function once to take a folder full of cubes and turn them
into single-frame fits files. Can <strong>not</strong> be called on non-cubes. Only
used for WIRCam.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.divide_WIRCam">
<span class="sig-name descname"><span class="pre">divide_WIRCam</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.divide_WIRCam" title="Permalink to this definition"></a></dt>
<dd><p>For a directory full of WIRCam images, if the images are cubes,
<strong>divide</strong> the multiple 2D arrays into individual arrays.</p>
<p class="rubric">Notes</p>
<p>Use this function once to take a folder full of cubes and turn them
into single-frame fits files. Can <strong>not</strong> be called on non-cubes.
Only used for WIRCam.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.crop_images">
<span class="sig-name descname"><span class="pre">crop_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frac_hori</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_vert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">1]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.crop_images" title="Permalink to this definition"></a></dt>
<dd><p>Crop several fits images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frac_hori, frac_vert</strong> (<em>length-two list, optional</em>) – Horizontal and vertical fractions of the images to crop (default
[0,1] for both –&gt; no cropping)</p>
</dd>
</dl>
<p>For a directory full of WIRCam/MegaPrime images (should <strong>not</strong> be
cubes), crops the images based on the input x-axis and y-axis
boundaries and writes them all to a new directory.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.crop_images_wcs">
<span class="sig-name descname"><span class="pre">crop_images_wcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.crop_images_wcs" title="Permalink to this definition"></a></dt>
<dd><p>Crop several fits images by picking out a source based on its RA
and Dec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – Right Ascension (RA) and Declination of interest, in degrees</p></li>
<li><p><strong>size</strong> (<em>float</em>) – Size of a box (in pixels) to crop around the input coordinates</p></li>
</ul>
</dd>
</dl>
<p>For a directory full of WIRCam/MegaPrime images (should <strong>not</strong> be
cubes), crops the images based on the input WCS coordinates, creating
a box centred on these coordinates and writing the new files to a new
directory. If the given box extends beyond the bounds of the image,
the box will be truncated at these bounds.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.make_badpix_masks">
<span class="sig-name descname"><span class="pre">make_badpix_masks</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.make_badpix_masks" title="Permalink to this definition"></a></dt>
<dd><p>Builds a bad pixel mask for all image files, and places them in a
new directory which is stored in <a class="reference internal" href="#alala.alala.Stack.bp_dir" title="alala.alala.Stack.bp_dir"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stack.bp_dir</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.make_stacks">
<span class="sig-name descname"><span class="pre">make_stacks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">filters</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.make_stacks" title="Permalink to this definition"></a></dt>
<dd><p>Co-add images with PyRaf.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filters</strong> (<em>str, optional</em>) – Filters of interest (defaults to all of the filters for which
there is raw data)</p>
</dd>
</dl>
<p>Uses PyRaf to coadd all of the raw data into stacks based on filter.
Can specify a subset of these filters if you don’t want to process all
of them at once.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.RawData.extract_stack">
<span class="sig-name descname"><span class="pre">extract_stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.RawData.extract_stack" title="Permalink to this definition"></a></dt>
<dd><p>Given a filter, create a <a class="reference internal" href="#alala.alala.Stack" title="alala.alala.Stack"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stack</span></code></a> object which contains only
stacks in that filter, from a base <a class="reference internal" href="#alala.alala.RawData" title="alala.alala.RawData"><code class="xref py py-class docutils literal notranslate"><span class="pre">RawData</span></code></a> object.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="alala.alala.Stack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">alala.alala.</span></span><span class="sig-name descname"><span class="pre">Stack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">location</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack_directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qso_grade_limit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_ext</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#alala.alala.RawData" title="alala.alala.RawData"><code class="xref py py-class docutils literal notranslate"><span class="pre">RawData</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.stack_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stack_size</span></span><a class="headerlink" href="#alala.alala.Stack.stack_size" title="Permalink to this definition"></a></dt>
<dd><p>Number of files used in the stacking</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.stack_time">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stack_time</span></span><a class="headerlink" href="#alala.alala.Stack.stack_time" title="Permalink to this definition"></a></dt>
<dd><p>Observation time in Modified Julian Date (MJD)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.image_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">image_data</span></span><a class="headerlink" href="#alala.alala.Stack.image_data" title="Permalink to this definition"></a></dt>
<dd><p>Stacked image data</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.image_header">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">image_header</span></span><a class="headerlink" href="#alala.alala.Stack.image_header" title="Permalink to this definition"></a></dt>
<dd><p>Image fits header</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.bp_dir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bp_dir</span></span><a class="headerlink" href="#alala.alala.Stack.bp_dir" title="Permalink to this definition"></a></dt>
<dd><p>Directory containing the bad pixel mask</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.calib_dir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calib_dir</span></span><a class="headerlink" href="#alala.alala.Stack.calib_dir" title="Permalink to this definition"></a></dt>
<dd><p>Directory containing photometric/astrometric calibration files</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.exptime">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">exptime</span></span><a class="headerlink" href="#alala.alala.Stack.exptime" title="Permalink to this definition"></a></dt>
<dd><p>Total exposure time of the stacked image</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.pixscale">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pixscale</span></span><a class="headerlink" href="#alala.alala.Stack.pixscale" title="Permalink to this definition"></a></dt>
<dd><p>Pixel scale of the instrument used</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.x_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">x_size</span></span><a class="headerlink" href="#alala.alala.Stack.x_size" title="Permalink to this definition"></a></dt>
<dd><p><cite>x</cite> dimension of the image, in pixels</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.y_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">y_size</span></span><a class="headerlink" href="#alala.alala.Stack.y_size" title="Permalink to this definition"></a></dt>
<dd><p><cite>y</cite> dimension of the image, in pixels</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.astrometric_calib">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">astrometric_calib</span></span><a class="headerlink" href="#alala.alala.Stack.astrometric_calib" title="Permalink to this definition"></a></dt>
<dd><p>Has astrometric calibration been performed?</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.psf_fit">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">psf_fit</span></span><a class="headerlink" href="#alala.alala.Stack.psf_fit" title="Permalink to this definition"></a></dt>
<dd><p>Has the effective Point-Spread Function (ePSF) been fit?</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.photometric_calib">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">photometric_calib</span></span><a class="headerlink" href="#alala.alala.Stack.photometric_calib" title="Permalink to this definition"></a></dt>
<dd><p>Has photometric calibration (i.e., obtaining a zero point) been
performed?</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.aperture_fit">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">aperture_fit</span></span><a class="headerlink" href="#alala.alala.Stack.aperture_fit" title="Permalink to this definition"></a></dt>
<dd><p>Has aperture photometry been performed?</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.bkg">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bkg</span></span><a class="headerlink" href="#alala.alala.Stack.bkg" title="Permalink to this definition"></a></dt>
<dd><p>Background-only image</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.bp_mask">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">bp_mask</span></span><a class="headerlink" href="#alala.alala.Stack.bp_mask" title="Permalink to this definition"></a></dt>
<dd><p>Bad pixel mask; array of <strong>bools</strong></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.source_mask">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">source_mask</span></span><a class="headerlink" href="#alala.alala.Stack.source_mask" title="Permalink to this definition"></a></dt>
<dd><p>Mask of sources; array of <strong>ints</strong>, where 0=non-masked and
1=masked</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.image_error">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">image_error</span></span><a class="headerlink" href="#alala.alala.Stack.image_error" title="Permalink to this definition"></a></dt>
<dd><p>Estimate of the error (Gaussian + Poisson) across the image</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.image_data_bkgsub">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">image_data_bkgsub</span></span><a class="headerlink" href="#alala.alala.Stack.image_data_bkgsub" title="Permalink to this definition"></a></dt>
<dd><p>Background-subtracted image data</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.xy_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xy_data</span></span><a class="headerlink" href="#alala.alala.Stack.xy_data" title="Permalink to this definition"></a></dt>
<dd><p>Table of (x, y) coordinates for sources found with astrometry.net</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.xy_name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">xy_name</span></span><a class="headerlink" href="#alala.alala.Stack.xy_name" title="Permalink to this definition"></a></dt>
<dd><p>Name of the file containing <a class="reference internal" href="#alala.alala.Stack.xy_data" title="alala.alala.Stack.xy_data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stack.xy_data</span></code></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.epsf_data">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">epsf_data</span></span><a class="headerlink" href="#alala.alala.Stack.epsf_data" title="Permalink to this definition"></a></dt>
<dd><p>Effective Point-Spread Function (ePSF) data</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.epsf_radius">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">epsf_radius</span></span><a class="headerlink" href="#alala.alala.Stack.epsf_radius" title="Permalink to this definition"></a></dt>
<dd><p>Radius of the effective Point Spread Function (ePSF), in pixels</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.ref_cat">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ref_cat</span></span><a class="headerlink" href="#alala.alala.Stack.ref_cat" title="Permalink to this definition"></a></dt>
<dd><p>Vizier code/ID for the reference catalogue used in photometric
calibration</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.ref_cat_name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ref_cat_name</span></span><a class="headerlink" href="#alala.alala.Stack.ref_cat_name" title="Permalink to this definition"></a></dt>
<dd><p>Name of the reference catalogue used in photometric calibration</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.zp_mean">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">zp_mean</span></span><a class="headerlink" href="#alala.alala.Stack.zp_mean" title="Permalink to this definition"></a></dt>
<dd><p>Mean zero point from photometric calibration</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.zp_med">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">zp_med</span></span><a class="headerlink" href="#alala.alala.Stack.zp_med" title="Permalink to this definition"></a></dt>
<dd><p>Median zero point from photometric calibration</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.zp_std">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">zp_std</span></span><a class="headerlink" href="#alala.alala.Stack.zp_std" title="Permalink to this definition"></a></dt>
<dd><p>Standard deviation (uncertainty) of the zero point from photometric
calibration</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.ra_offsets_mean">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ra_offsets_mean</span></span><a class="headerlink" href="#alala.alala.Stack.ra_offsets_mean" title="Permalink to this definition"></a></dt>
<dd><p>Mean offset in Right Ascension (RA) between the image and
reference catalogue</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.dec_offsets_mean">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dec_offsets_mean</span></span><a class="headerlink" href="#alala.alala.Stack.dec_offsets_mean" title="Permalink to this definition"></a></dt>
<dd><p>Mean offset in Declination between the image and reference
catalogue</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.nmatches">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nmatches</span></span><a class="headerlink" href="#alala.alala.Stack.nmatches" title="Permalink to this definition"></a></dt>
<dd><p>Number of matches between astrometry-detected sources in the image
and the reference catalogue</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.sep_mean">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sep_mean</span></span><a class="headerlink" href="#alala.alala.Stack.sep_mean" title="Permalink to this definition"></a></dt>
<dd><p>Mean separation between sources, in arcseconds</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.mag_diff_mean">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mag_diff_mean</span></span><a class="headerlink" href="#alala.alala.Stack.mag_diff_mean" title="Permalink to this definition"></a></dt>
<dd><p>Mean difference between <strong>calibrated</strong> magnitudes and reference
catalogue magnitudes</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.psf_sources">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">psf_sources</span></span><a class="headerlink" href="#alala.alala.Stack.psf_sources" title="Permalink to this definition"></a></dt>
<dd><p>Table of sources detected by point-spread function (PSF)
photometry</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.aperture_sources">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">aperture_sources</span></span><a class="headerlink" href="#alala.alala.Stack.aperture_sources" title="Permalink to this definition"></a></dt>
<dd><p>Table of sources detected by aperture photometry</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.alala.Stack.limmag_sources">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">limmag_sources</span></span><a class="headerlink" href="#alala.alala.Stack.limmag_sources" title="Permalink to this definition"></a></dt>
<dd><p>Table of “sources” for which we have a limiting magnitude</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.Stack.mask_bp">
<span class="sig-name descname"><span class="pre">mask_bp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack.mask_bp" title="Permalink to this definition"></a></dt>
<dd><p>Make a bad pixel mask of pixels = 0 or nan. The mask is an array of
<strong>bools</strong>, contained in <a class="reference internal" href="#alala.alala.Stack.bp_mask" title="alala.alala.Stack.bp_mask"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stack.bp_mask</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.Stack.mask_source">
<span class="sig-name descname"><span class="pre">mask_source</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack.mask_source" title="Permalink to this definition"></a></dt>
<dd><p>Make a mask of pixels containing sources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sigma</strong> (<em>float, optional</em>) – Detection sigma to use in image segmentation (default 3.0)</p>
</dd>
</dl>
<p>Use crude image segmentation to make a proto source mask, use the mask
to get the background, and then perform proper image segmentation on
the background-subtracted image data. The resulting segmentation image
is a proper source mask, to be used in other steps in aperture
photometry. The output source mask also flags bad pixels.</p>
<p class="rubric">Notes</p>
<p>The mask is an array of <strong>ints</strong>, where 1=masked, 0=non-masked. Will
be contained in <a class="reference internal" href="#alala.alala.Stack.source_mask" title="alala.alala.Stack.source_mask"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stack.source_mask</span></code></a>, Not to be confused with
<a class="reference internal" href="#alala.alala.Stack.bp_mask" title="alala.alala.Stack.bp_mask"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stack.bp_mask</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.Stack.bkg_compute">
<span class="sig-name descname"><span class="pre">bkg_compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack.bkg_compute" title="Permalink to this definition"></a></dt>
<dd><p>Compute the background of the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box_size</strong> (<em>int, optional</em>) – Size of box for background estimation (default 50 –&gt; 50x50 boxes)</p></li>
<li><p><strong>filter_size</strong> (<em>int, optional</em>) – Size of the median filter applied during background estimation
(default 5 –&gt; 5x5 filter)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float, optional</em>) – Detection to use in image segmentation when producing a source
mask (default 3.0; only relevant if a source mask does not already
exist and needs to be computed)</p></li>
</ul>
</dd>
</dl>
<p>Computes the background of the image, the error on the background (as
the RMS deviation), and the background-subtracted image. Assigns these
to the attributes <a class="reference internal" href="#alala.alala.Stack.bkg" title="alala.alala.Stack.bkg"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stack.bkg</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Stack.bkg_rms</span></code>,
<a class="reference internal" href="#alala.alala.Stack.image_data_bkgsub" title="alala.alala.Stack.image_data_bkgsub"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stack.image_data_bkgsub</span></code></a>.</p>
<p class="rubric">Notes</p>
<p>A new source mask will be obtained only if <a class="reference internal" href="#alala.alala.Stack.source_mask" title="alala.alala.Stack.source_mask"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stack.source_mask</span></code></a>
does not exist.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.Stack.error_array">
<span class="sig-name descname"><span class="pre">error_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack.error_array" title="Permalink to this definition"></a></dt>
<dd><p>Compute the error (uncertainty) on the background-only image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>box_size</strong> (<em>int, optional</em>) – Size of box for background estimation (default 50 –&gt; 50x50 boxes;
only relevant if background not previously computed)</p></li>
<li><p><strong>filter_size</strong> (<em>int, optional</em>) – Size of the median filter applied during background estimation
(default 5 –&gt; 5x5 filter, only relevant if background not
previously computed)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float, optional</em>) – Detection to use in image segmentation when producing a source
mask (default 3.0; only relevant if source mask not previously
computed)</p></li>
</ul>
</dd>
</dl>
<p>Computes the error on the background-only image as the RMS deviation
of the background, and then computes the total image error including
the contribution of the Poisson noise from detected sources. Necessary
for error propagation in aperture photometry.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.Stack.make_image">
<span class="sig-name descname"><span class="pre">make_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bkgsub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">border</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sources</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack.make_image" title="Permalink to this definition"></a></dt>
<dd><p>Make a plot of the stacked image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bkgsub</strong> (<em>bool, optional</em>) – Plot the <strong>background-subtracted</strong> data? (default False)</p></li>
<li><p><strong>border</strong> (<em>bool, optional</em>) – Demarcate the region in which sources are valid for photometry?
(default False)</p></li>
<li><p><strong>sources</strong> (<em>bool, optional</em>) – Drop circles on detected sources? (default False)</p></li>
<li><p><strong>ra, dec</strong> (<em>float, optional</em>) – Right Ascension (RA) and Declination at which to place a crosshair
(default None)</p></li>
<li><p><strong>scale</strong> (<em>{None, “log”, “asinh”}, optional</em>) – Scale to apply to the images (default None –&gt; linear scale)</p></li>
<li><p><strong>title</strong> (<em>str, optional</em>) – Title to place above the plot (default None –&gt; no title)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for the output image file (default None –&gt; set automatically)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.Stack.astrometry">
<span class="sig-name descname"><span class="pre">astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack.astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Perform source extraction with astrometry.net and solve the field.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>verbose</strong> (<em>int, optional</em>) – Level of verbosity within astrometry.net (default 0)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>After running this function, can obtain a list of detected sources’
(x, y) coordinates from attribute <code class="xref py py-class docutils literal notranslate"><span class="pre">self.xy_data</span></code> <strong>or</strong> by
reading the fits file <a class="reference internal" href="#alala.alala.Stack.xy_name" title="alala.alala.Stack.xy_name"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stack.xy_name</span></code></a></p></li>
<li><p>Creates a new file appended with <cite>_updated.fits</cite> with the new
astrometric solution</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.Stack.fit_PSF">
<span class="sig-name descname"><span class="pre">fit_PSF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nstars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elongation_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_ePSF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ePSF_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_residuals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resid_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack.fit_PSF" title="Permalink to this definition"></a></dt>
<dd><p>Fit for the effective Point-Spread Function (ePSF) of the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nstars</strong> (<em>int, optional</em>) – <strong>Maximum</strong> number of stars to use in building the ePSF (default
40; set to None to impose no limit)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float, optional</em>) – Sigma threshold for source detection with image segmentation
(default 5.0)</p></li>
<li><p><strong>pixelmin</strong> (<em>int, optional</em>) – <strong>Minimum</strong> number of contiguous pixels for an isophote to be
considered a source (default 20)</p></li>
<li><p><strong>elongation_lim</strong> (<em>float, optional</em>) – <strong>Maximum</strong> elongation (ratio of semimajor axis / semiminor axis)
for an isophote to be considered a source (default 1.4)</p></li>
<li><p><strong>area_max</strong> (<em>float, optional</em>) – <strong>Maximum</strong> pixel area (in pix**2) for an isophote to be
considered a source (default 500)</p></li>
<li><p><strong>cutout</strong> (<em>int, optional</em>) – Size of the cutout around each star, in pix (default 35; must be
<strong>odd</strong>, will be rounded down if eve)</p></li>
<li><p><strong>source_lim</strong> (<em>int, optional</em>) – Limit on the number of sources to fit with the ePSF (default None)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Write the ePSF to a .fits file as an image? (default False)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for the output .fits file (default None –&gt; set
automatically; only relevant if <cite>write=True</cite>)</p></li>
<li><p><strong>plot_ePSF</strong> (<em>bool, optional</em>) – Plot the ePSF? (default False)</p></li>
<li><p><strong>ePSF_name</strong> (<em>str, optional</em>) – Name for the output plot of the ePSF? (default None –&gt; set
automatically; only relevant if <cite>plot_ePSF=True</cite>)</p></li>
<li><p><strong>plot_residuals</strong> (<em>bool, optional</em>) – Plot the residuals of the iterative PSF fitting? (default False)</p></li>
<li><p><strong>resid_name</strong> (<em>str, optional</em>) – Name for the output plot of the residuals (default None –&gt; set
automatically; only relevant if <cite>plot_residuals=True</cite>)</p></li>
</ul>
</dd>
</dl>
<p>Uses image segmentation to obtain a list of sources in the smoothed,
background-subtracted image (provided by astrometry.net) with their
x, y coordinates. Uses <cite>EPSFBuilder</cite> to empirically obtain the ePSF of
these stars. Uses astrometry.net to find all sources in the image, and
fits them with the empirically obtained ePSF. Builds a table
containing the instrumental magnitudes and corresponding uncertainties
to be used in obtaining the zero point for PSF calibration, in
<a class="reference internal" href="#alala.alala.Stack.psf_sources" title="alala.alala.Stack.psf_sources"><code class="xref py py-class docutils literal notranslate"><span class="pre">Stack.psf_sources</span></code></a>.</p>
<p class="rubric">Notes</p>
<p>The ePSF obtained here should <strong>NOT</strong> be used in convolutions.
Instead, it can serve as a tool for estimating the seeing of an image.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.Stack.zero_point">
<span class="sig-name descname"><span class="pre">zero_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sep_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_source_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_offs_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_field_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_offs_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_blur_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack.zero_point" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the zero point of the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sep_max</strong> (<em>float, optional</em>) – <strong>Maximum</strong> allowed separation when cross-matching sources, in pix
(default 2.0; corresponds to ~ 0.6” for WIRCam and ~ 0.37” for
MegaPrime)</p></li>
<li><p><strong>plot_corr</strong> (<em>bool, optional</em>) – Plot the correlation plot with a linear fit (i.e., instrumental
source magnitude in the image versus calibrated catalogue
magnitude)? (default True)</p></li>
<li><p><strong>corr_name</strong> (<em>str, optional</em>) – Name for the output correlation plot (default None –&gt; set
automatically; only relevant if <cite>plot_corr=True</cite>)</p></li>
<li><p><strong>plot_source_offsets</strong> (<em>bool, optional</em>) – Plot the offsets between the image and catalogue in Right
Ascension (RA) and Declination (Dec) space, for all sources?
(default True)</p></li>
<li><p><strong>source_offs_name</strong> (<em>str, optional</em>) – Name for the output offsets plot (default None –&gt; set
automatically; only relevant if <cite>plot_source_offsets=True</cite>)</p></li>
<li><p><strong>plot_field_offsets</strong> (<em>bool, optional</em>) – Plot the offsets over the image itself, with some Gaussian blur
for legibility? (default False)</p></li>
<li><p><strong>field_offs_name</strong> (<em>str, optional</em>) – Name for the output field offsets plot (default None –&gt; set
automatically; only relevant if <cite>plot_field_offsets=True</cite>)</p></li>
<li><p><strong>gaussian_blur_sigma</strong> (<em>float, optional</em>) – Standard deviation (sigma) of the Gaussian blur to apply if
plotting the field offsets (default 30.0; only relevant if
<cite>plot_field_offsets=True</cite>)</p></li>
<li><p><strong>cat_num</strong> (<em>str, optional</em>) – Vizier catalogue number for the catalogue to use in cross-matching
(default None –&gt; set automatically according to the filter in use)</p></li>
</ul>
</dd>
</dl>
<p>Uses astroquery and Vizier to query an online catalogue for sources
which match those detected by astrometry. Computes the offset between
the apparent and instrumental magnitudes of the queried sources for
photometric calibration. Computes the mean, median and standard
deviation.</p>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>For filters , “g”, “r”, “i”, “z”, “Y”, the default catalogue is
Pan-STARRS 1</p></li>
<li><p>For filter “u”, the default catalogue is SDSS DR12</p></li>
<li><p>For filter “Ks” (“K”), the default catalogue is 2MASS</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.Stack.PSF_photometry">
<span class="sig-name descname"><span class="pre">PSF_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nstars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elongation_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_blur_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_ePSF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ePSF_data_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_ePSF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ePSF_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_resid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resid_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_source_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_offs_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_field_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_offs_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack.PSF_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the effective Point-Spread Function (ePSF) of the image,
perform zero point calibration, and perform PSF photometry on all
detected sources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nstars</strong> (<em>int, optional</em>) – <strong>Maximum</strong> number of stars to use in building the ePSF (default
40; set to None to impose no limit)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float, optional</em>) – Sigma threshold for source detection with image segmentation
(default 5.0)</p></li>
<li><p><strong>pixelmin</strong> (<em>int, optional</em>) – <strong>Minimum</strong> number of contiguous pixels for an isophote to be
considered a source (default 20)</p></li>
<li><p><strong>elongation_lim</strong> (<em>float, optional</em>) – <strong>Maximum</strong> elongation (ratio of semimajor axis / semiminor axis)
for an isophote to be considered a source (default 1.4)</p></li>
<li><p><strong>area_max</strong> (<em>float, optional</em>) – <strong>Maximum</strong> pixel area (in pix**2) for an isophote to be
considered a source (default 500)</p></li>
<li><p><strong>cutout</strong> (<em>int, optional</em>) – Size of the cutout around each star, in pix (default 35; must be
<strong>odd</strong>, will be rounded down if eve)</p></li>
<li><p><strong>source_lim</strong> (<em>int, optional</em>) – Limit on the number of sources to fit with the ePSF (default None)</p></li>
<li><p><strong>gaussian_blur_sigma</strong> (<em>float, optional</em>) – Standard deviation (sigma) of the Gaussian blur to apply if
plotting the field offsets (default 30.0; only relevant if
<cite>plot_field_offsets=True</cite>)</p></li>
<li><p><strong>cat_num</strong> (<em>str, optional</em>) – Vizier catalogue number for the catalogue to use in cross-matching
(default None –&gt; set automatically according to the filter in use)</p></li>
<li><p><strong>sep_max</strong> (<em>float, optional</em>) – <strong>Maximum</strong> allowed separation when cross-matching sources, in pix
(default 2.0; corresponds to ~ 0.6” for WIRCam and ~ 0.37” for
MegaPrime)</p></li>
<li><p><strong>box_size</strong> (<em>int, optional</em>) – Size of box for background estimation (default 50 –&gt; 50x50 boxes;
only relevant if background not previously computed)</p></li>
<li><p><strong>filter_size</strong> (<em>int, optional</em>) – Size of the median filter applied during background estimation
(default 5 –&gt; 5x5 filter, only relevant if background not
previously computed)</p></li>
<li><p><strong>write_ePSF</strong> (<em>bool, optional</em>) – Write the ePSF to a .fits file as an image? (default False)</p></li>
<li><p><strong>ePSF_data_name</strong> (<em>str, optional</em>) – Name for the output .fits file (default None –&gt; set
automatically; only relevant if <cite>write_ePSF=True</cite>)</p></li>
<li><p><strong>plot_ePSF</strong> (<em>bool, optional</em>) – Plot the ePSF? (default False)</p></li>
<li><p><strong>ePSF_name</strong> (<em>str, optional</em>) – Name for the output plot of the ePSF? (default None –&gt; set
automatically; only relevant if <cite>plot_ePSF=True</cite>)</p></li>
<li><p><strong>plot_residuals</strong> (<em>bool, optional</em>) – Plot the residuals of the iterative PSF fitting? (default False)</p></li>
<li><p><strong>resid_name</strong> (<em>str, optional</em>) – Name for the output plot of the residuals (default None –&gt; set
automatically; only relevant if <cite>plot_residuals=True</cite>)</p></li>
<li><p><strong>plot_corr</strong> (<em>bool, optional</em>) – Plot the correlation plot with a linear fit (i.e., instrumental
source magnitude in the image versus calibrated catalogue
magnitude)? (default True)</p></li>
<li><p><strong>corr_name</strong> (<em>str, optional</em>) – Name for the output correlation plot (default None –&gt; set
automatically; only relevant if <cite>plot_corr=True</cite>)</p></li>
<li><p><strong>plot_source_offsets</strong> (<em>bool, optional</em>) – Plot the offsets between the image and catalogue in Right
Ascension (RA) and Declination (Dec) space, for all sources?
(default True)</p></li>
<li><p><strong>source_offs_name</strong> (<em>str, optional</em>) – Name for the output offsets plot (default None –&gt; set
automatically; only relevant if <cite>plot_source_offsets=True</cite>)</p></li>
<li><p><strong>plot_field_offsets</strong> (<em>bool, optional</em>) – Plot the offsets over the image itself, with some Gaussian blur
for legibility? (default False)</p></li>
<li><p><strong>field_offs_name</strong> (<em>str, optional</em>) – Name for the output field offsets plot (default None –&gt; set
automatically; only relevant if <cite>plot_field_offsets=True</cite>)</p></li>
</ul>
</dd>
</dl>
<p>Using image segmentation, finds as many sources as possible in the
image with an elongation below some elongation limit. Uses these
sources to build an empirical effective PSF (ePSF). Using a list of
sources found by astrometry.net, fits the ePSF to all of those sources.
Computes the instrumental magnitude of all of these sources. Queries
the correct online catalogue for the given filter to crossmatch sources
in the image with those in the catalogue (e.g., Pan-STARRS 1). Finds
the zero point which satisfies AB_mag = ZP + instrumental_mag and gets
the calibrated AB mags for all PSF-fit sources.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.Stack.write_PSF_photometry">
<span class="sig-name descname"><span class="pre">write_PSF_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nstars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elongation_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_blur_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_ePSF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ePSF_data_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_ePSF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ePSF_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_resid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resid_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_source_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_offs_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_field_offsets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_offs_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack.write_PSF_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Write the results of PSF photometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>…</strong> – all of the inputs to <a class="reference internal" href="#alala.alala.Stack.PSF_photometry" title="alala.alala.Stack.PSF_photometry"><code class="xref py py-func docutils literal notranslate"><span class="pre">Stack.PSF_photometry()</span></code></a></p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name of the output .fits file (default None –&gt; set automatically)</p></li>
</ul>
</dd>
</dl>
<p>Performs PSF photometry if it has not already been performed, and then
writes a table of the PSF-fit sources to a .fits table.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.Stack.aperture_photometry">
<span class="sig-name descname"><span class="pre">aperture_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkgsub_verify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_annulus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ann_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_aperture</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack.aperture_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Do aperture photometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra_list, dec_list</strong> (<em>list **or*</em> float*) – List or single float of the Right Ascension (RA), Declination
around some source of interest</p></li>
<li><p><strong>sigma</strong> (<em>float, optional</em>) – Limiting sigma below which a source is labeled as <strong>not</strong>
detected, in which case the user should use
<a class="reference internal" href="#alala.alala.Stack.limiting_magnitude" title="alala.alala.Stack.limiting_magnitude"><code class="xref py py-func docutils literal notranslate"><span class="pre">Stack.limiting_magnitude()</span></code></a></p></li>
<li><p><strong>ap_radius</strong> (<em>float, optional</em>) – Radius of the aperture, in arcseconds (default 1.2)</p></li>
<li><p><strong>r1, r2</strong> (<em>float, optional</em>) – Inner and outer radii of the annulus, <strong>in arcseconds</strong> (default
2.0, 5.0)</p></li>
<li><p><strong>box_size</strong> (<em>int, optional</em>) – Size of box for background estimation (default 50 –&gt; 50x50 boxes;
only relevant if background not previously computed)</p></li>
<li><p><strong>filter_size</strong> (<em>int, optional</em>) – Size of the median filter applied during background estimation
(default 5 –&gt; 5x5 filter, only relevant if background not
previously computed)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float, optional</em>) – Detection to use in image segmentation when producing a source
mask (default 3.0; only relevant if a source mask does not already
exist and needs to be computed)</p></li>
<li><p><strong>plot_annulus</strong> (<em>bool, optional</em>) – Plot the image data <strong>contained in the annulus</strong>, centered on the
ra, dec of interest? (default False)</p></li>
<li><p><strong>ann_name</strong> (<em>str, optional</em>) – Name for the plot of the annulus image data (default None –&gt; set
automatically)</p></li>
<li><p><strong>plot_aperture</strong> (<em>bool, optional</em>) – Plot the aperture and annulus as rings (default False)</p></li>
<li><p><strong>ap_name</strong> (<em>str, optional</em>) – Name for the output aperture+annulus plot (default None –&gt; set
automatically)</p></li>
</ul>
</dd>
</dl>
<p>Computes the the total flux in a defined aperture around the given RA,
Dec, computes the background in an annulus around this aperture, and
computes the background-subtracted flux of the “source” defined by the
aperture. Can be called multiple times if a list of RA/Dec is given.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.Stack.limiting_magnitude">
<span class="sig-name descname"><span class="pre">limiting_magnitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_annulus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ann_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_aperture</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack.limiting_magnitude" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the limiting magnitude at some coordinates for some <cite>sigma</cite>
significance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra_list, dec_list</strong> (<em>list **or*</em> float*) – List or single float of the Right Ascension (RA), Declination
around some source of interest</p></li>
<li><p><strong>sigma</strong> (<em>float, optional</em>) – Detection significance (default 5.0)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float, optional</em>) – Detection to use in image segmentation when producing a source
mask (default 3.0; only relevant if a source mask does not already
exist and needs to be computed)</p></li>
<li><p><strong>box_size</strong> (<em>int, optional</em>) – Size of box for background estimation (default 50 –&gt; 50x50 boxes;
only relevant if background not previously computed)</p></li>
<li><p><strong>filter_size</strong> (<em>int, optional</em>) – Size of the median filter applied during background estimation
(default 5 –&gt; 5x5 filter, only relevant if background not
previously computed)</p></li>
<li><p><strong>plot_annulus</strong> (<em>bool, optional</em>) – Plot the image data <strong>contained in the annulus</strong>, centered on the
ra, dec of interest? (default True)</p></li>
<li><p><strong>ann_name</strong> (<em>str, optional</em>) – Name for the plot of the annulus image data (default None –&gt; set
automatically)</p></li>
<li><p><strong>plot_aperture</strong> (<em>bool, optional</em>) – Plot the aperture and annulus as rings (default False)</p></li>
<li><p><strong>ap_name</strong> (<em>str, optional</em>) – Name for the output aperture+annulus plot (default None –&gt; set
automatically)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Write the results to a table? (default False)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for the output table (default None –&gt; set automatically; only
relevant if <cite>write=True</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Limiting magnitude</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a given RA, Dec, finds the limiting magnitude at its location. If
a source was previously detected &lt;= 3” away from the given coords by
astrometry.net, the limiting magnitude at the RA, Dec given will be
invalid, and so the aperture will randomly jitter until a valid
RA, Dec is found.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.Stack.write_aperture_photometry">
<span class="sig-name descname"><span class="pre">write_aperture_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack.write_aperture_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Write the sources detected by aperture photometry to a table.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.Stack.write_limiting_magnitude">
<span class="sig-name descname"><span class="pre">write_limiting_magnitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack.write_limiting_magnitude" title="Permalink to this definition"></a></dt>
<dd><p>Write the “sources” with limiting magnitudes computed by aperture
photometry to a table.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.Stack.compare_photometry">
<span class="sig-name descname"><span class="pre">compare_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ap_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack.compare_photometry" title="Permalink to this definition"></a></dt>
<dd><p>Compare the calibrated magnitude obtained with aperture photometry
(<a class="reference internal" href="#alala.alala.Stack.aperture_photometry" title="alala.alala.Stack.aperture_photometry"><code class="xref py py-func docutils literal notranslate"><span class="pre">Stack.aperture_photometry()</span></code></a>) to that obtained with PSF
photometry (<a class="reference internal" href="#alala.alala.Stack.PSF_photometry" title="alala.alala.Stack.PSF_photometry"><code class="xref py py-func docutils literal notranslate"><span class="pre">Stack.PSF_photometry()</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ap_radius</strong> (<em>float, optional</em>) – Radius of the aperture, in arcseconds (default 1.2)</p></li>
<li><p><strong>r1, r2</strong> (<em>float, optional</em>) – Inner and outer annuli radii, where the annulus is used for
estimating the background (default 2.0, 5.0)</p></li>
<li><p><strong>nsamples</strong> (<em>int, optional</em>) – Number of samples to take from PSF photometry</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name of the output figure comparing the two photometries (default
None –&gt; set automatically)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.Stack.source_selection">
<span class="sig-name descname"><span class="pre">source_selection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack.source_selection" title="Permalink to this definition"></a></dt>
<dd><p>Parse the table of sources provided by PSF photometry
(<a class="reference internal" href="#alala.alala.Stack.PSF_photometry" title="alala.alala.Stack.PSF_photometry"><code class="xref py py-func docutils literal notranslate"><span class="pre">Stack.PSF_photometry()</span></code></a>) for sources within some distance of
the given coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – Right Ascension (RA) and Declination for the source of interest</p></li>
<li><p><strong>radius</strong> (<em>float</em>) – Radius to search in, in arcseconds (default 1.0)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Table of the source(s) satisfying the conditions</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.table.Table</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.alala.Stack.write_selection">
<span class="sig-name descname"><span class="pre">write_selection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.alala.Stack.write_selection" title="Permalink to this definition"></a></dt>
<dd><p>Write some selection of sources based on coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>…</strong> – all of the inputs to <a class="reference internal" href="#alala.alala.Stack.source_selection" title="alala.alala.Stack.source_selection"><code class="xref py py-func docutils literal notranslate"><span class="pre">Stack.source_selection()</span></code></a></p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name of the output .fits table (default None –&gt; set automatically)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-alala.apphotom">
<span id="alala-apphotom-module"></span><h2>alala.apphotom module<a class="headerlink" href="#module-alala.apphotom" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>CONTENTS:</dt><dd><ul class="simple">
<li><p><a class="reference internal" href="#alala.apphotom.image2xy" title="alala.apphotom.image2xy"><code class="xref py py-func docutils literal notranslate"><span class="pre">image2xy()</span></code></a>: Make a list of sources with <cite>astrometry.net</cite></p></li>
<li><p><a class="reference internal" href="#alala.apphotom.imsegm_make_source_mask" title="alala.apphotom.imsegm_make_source_mask"><code class="xref py py-func docutils literal notranslate"><span class="pre">imsegm_make_source_mask()</span></code></a>: Make a mask of sources using image
segmentation</p></li>
<li><p><a class="reference internal" href="#alala.apphotom.error_array" title="alala.apphotom.error_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">error_array()</span></code></a>: Compute the combination of the Gaussian +
Poissonian error in the image</p></li>
<li><p><a class="reference internal" href="#alala.apphotom.aperture_photom" title="alala.apphotom.aperture_photom"><code class="xref py py-func docutils literal notranslate"><span class="pre">aperture_photom()</span></code></a>: Perform aperture photometry on an image</p></li>
<li><p><a class="reference internal" href="#alala.apphotom.limiting_magnitude" title="alala.apphotom.limiting_magnitude"><code class="xref py py-func docutils literal notranslate"><span class="pre">limiting_magnitude()</span></code></a>: Get the limiting magnitude of an image</p></li>
</ul>
</dd>
<dt>NON-STANDARD PYTHON DEPENDENCIES:</dt><dd><ul class="simple">
<li><p><cite>astropy</cite></p></li>
<li><p><cite>photutils</cite></p></li>
</ul>
</dd>
<dt>NON-PYTHON DEPENDENCIES:</dt><dd><ul class="simple">
<li><p><cite>astrometry.net</cite></p></li>
</ul>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="alala.apphotom.image2xy">
<span class="sig-prename descclassname"><span class="pre">alala.apphotom.</span></span><span class="sig-name descname"><span class="pre">image2xy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrom_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.apphotom.image2xy" title="Permalink to this definition"></a></dt>
<dd><p>Use astrometry.net’s <cite>image2xy</cite> to detect sources in an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_file</strong> (<em>str</em>) – Filename for <strong>NOT background-subtracted</strong> image</p></li>
<li><p><strong>astrom_sigma</strong> (<em>float, optional</em>) – Sigma threshold for astrometry.net source detection image (default 5.0)</p></li>
<li><p><strong>psf_sigma</strong> (<em>float, optional</em>) – Sigma of the Gaussian PSF of the image (default 5.0)</p></li>
<li><p><strong>alim</strong> (<em>int, optional</em>) – Maximum allowed source area, in pixels**2, beyond which sources will
be deblended (default 10000)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Write the output list of sources? (default False)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output source list file (default set by function)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of sources</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.io.fits.fitsrec.FITS_rec</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Can write sources to a list of sources and/or a file to be used as a
source mask in aperture photometry.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alala.apphotom.imsegm_make_source_mask">
<span class="sig-prename descclassname"><span class="pre">alala.apphotom.</span></span><span class="sig-name descname"><span class="pre">imsegm_make_source_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.apphotom.imsegm_make_source_mask" title="Permalink to this definition"></a></dt>
<dd><p>Make a mask which contains sources in the image using image
segmentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_file</strong> (<em>str</em>) – Filename for <strong>NOT background-subtracted</strong> image</p></li>
<li><p><strong>mask_file</strong> (<em>str, optional</em>) – Filename for a bad pixel mask (default None)</p></li>
<li><p><strong>sigma</strong> (<em>float, optional</em>) – Detection sigma to use in image segmentation (default 3.0)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Write the source mask to a file? (default False)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output file (default set by function)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Source mask where 0 = background, 1 = source</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Use crude image segmentation to make a proto source mask, use the mask to
get the background, and then perform proper image segmentation on the
background-subtracted image data. The resulting segmentation image is a
source mask, to be used in other steps in aperture photometry. The
output source mask also flags bad pixels.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alala.apphotom.error_array">
<span class="sig-prename descclassname"><span class="pre">alala.apphotom.</span></span><span class="sig-name descname"><span class="pre">error_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.apphotom.error_array" title="Permalink to this definition"></a></dt>
<dd><p>Make an array of the error in an image, including root-mean-squared
deviation on the background and Poisson noise for detected sources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_file</strong> (<em>str</em>) – Filename for <strong>NOT background-subtracted</strong> image</p></li>
<li><p><strong>source_mask</strong> (<em>np.ndarray, str, optional</em>) – Filename for a source mask or the mask data itself (default None; in
which case a source mask is made)</p></li>
<li><p><strong>sigma</strong> (<em>float, optional</em>) – Detection sigma to use in image segmentation, <em>if</em> a source mask is to
be made (default 3.0; only relevant if <cite>source_mask = None</cite>)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Write the error array to a file? (default False)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output file (default set by function)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Image error array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Computes the error on the background-only image as the RMS deviation
of the background, and then computes the total image error including
the contribution of the Poisson noise for detected sources. Necessary
for error propagation in aperture photometry.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alala.apphotom.aperture_photom">
<span class="sig-prename descclassname"><span class="pre">alala.apphotom.</span></span><span class="sig-name descname"><span class="pre">aperture_photom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkgsub_verify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_annulus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_aperture</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ann_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bone'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.apphotom.aperture_photom" title="Permalink to this definition"></a></dt>
<dd><p>Perform aperture photometry on some image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_file</strong> (<em>str</em>) – Filename for <strong>NOT background-subtracted</strong> image</p></li>
<li><p><strong>ra, dec</strong> (<em>float, list</em>) – Floats <strong>or</strong> lists of RA, Dec of interest</p></li>
<li><p><strong>mask</strong> (<em>np.ndarray, str, optional</em>) – Filename for a source mask <strong>or</strong> the mask data itself (default None;
in which case a source mask is made)</p></li>
<li><p><strong>error</strong> (<em>np.ndarray, str, optional</em>) – Filename for image error <strong>or</strong> the image error itself (default None;
in which case an error array is made)</p></li>
<li><p><strong>sigma</strong> (<em>float, optional</em>) – Sigma below which to reject a source (default None –&gt; do not reject
any sources)</p></li>
<li><p><strong>bkgsub_verify</strong> (<em>bool, optional</em>) – Verify that the background-subtracted flux is non-negative? (default
True)</p></li>
<li><p><strong>ap_radius</strong> (<em>float, optional</em>) – Aperture radius, in arcseconds (default 1.2”)</p></li>
<li><p><strong>r1, r2</strong> (<em>float, optional</em>) – Inner and outer radius of the annulus, in arcseconds (default 2.0”,
5.0”)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float, optional</em>) – Detection sigma to use in image segmentation (default 3.0; only
relevant if mask and/or error are not given)</p></li>
<li><p><strong>plot_annulus</strong> (<em>bool, optional</em>) – Plot the annulus? (default True)</p></li>
<li><p><strong>plot_aperture</strong> (<em>bool, optional</em>) – Plot the aperture? (default True)</p></li>
<li><p><strong>ann_output</strong> (<em>str, optional</em>) – Name for output annulus plot (default None; set by function if
<cite>plot_annulus = True</cite>)</p></li>
<li><p><strong>ap_output</strong> (<em>str, optional</em>) – Name for output aperture plot (default None; set by function if
<cite>plot_aperture = True</cite>)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Write the resultant table? (default False)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for the output table file (default None; set by function if
<cite>write = True</cite>)</p></li>
<li><p><strong>cmap</strong> (<em>str, matplotlib.colors.ListedColormap, optional</em>) – Colormap for plots (default “bone”)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Table containing the results of aperture photometry</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Finds the total flux in a defined aperture, computes the background in an
annulus around this aperture, and computes the background-subtracted flux
of the “source” defined by the aperture. Will compute aperture photometry
for multiple sources if a list of RA/Decs is given.</p>
<p>If the background-subtracted flux at some location is negative, make sure
that no sources remain in the annulus of the data, or consider getting a
<strong>limiting magnitude</strong> at the RA, Dec of interest instead with
<a class="reference internal" href="#alala.apphotom.limiting_magnitude" title="alala.apphotom.limiting_magnitude"><code class="xref py py-func docutils literal notranslate"><span class="pre">limiting_magnitude()</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alala.apphotom.limiting_magnitude">
<span class="sig-prename descclassname"><span class="pre">alala.apphotom.</span></span><span class="sig-name descname"><span class="pre">limiting_magnitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrom_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_annulus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_aperture</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ann_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ap_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bone'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.apphotom.limiting_magnitude" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the limiting magnitude of some image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_file</strong> (<em>str</em>) – Filename for <strong>NOT background-subtracted</strong> image</p></li>
<li><p><strong>ra, dec</strong> (<em>float, list</em>) – Floats <strong>or</strong> lists of RA, Dec of interest</p></li>
<li><p><strong>source_list</strong> (<em>str, astropy.io.fits.fitsrec.FITS_rec, optional</em>) – Filename for source list <strong>or</strong> the source list fits bintable itself
(default None –&gt; make a list)</p></li>
<li><p><strong>mask</strong> (<em>np.ndarray, str, optional</em>) – Filename for a source mask <strong>or</strong> the mask data itself (default None;
in which case a source mask is made)</p></li>
<li><p><strong>error</strong> (<em>np.ndarray, str, optional</em>) – Filename for image error <strong>or</strong> the image error itself (default None;
in which case an error array is made)</p></li>
<li><p><strong>sigma</strong> (<em>float, optional</em>) – Sigma to use when computing limiting magnitude (default 5.0)</p></li>
<li><p><strong>astrom_sigma</strong> (<em>float, optional</em>) – Sigma threshold for astrometry.net source detection image (default 5.0)</p></li>
<li><p><strong>psf_sigma</strong> (<em>float, optional</em>) – Sigma of the Gaussian PSF of the image to be used in
astrometry.net(default 5.0)</p></li>
<li><p><strong>alim</strong> (<em>int, optional</em>) – Maximum allowed source area, in pixels**2, beyond which sources will
be deblended in astrometry.net (default 10000)</p></li>
<li><p><strong>ap_radius</strong> (<em>float, optional</em>) – Aperture radius, in arcseconds (default 1.2”)</p></li>
<li><p><strong>r1, r2</strong> (<em>float, optional</em>) – Inner and outer radius of the annulus, in arcseconds (default 2.0”,
10.0”)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float, optional</em>) – Detection sigma to use in image segmentation (default 3.0; only
relevant if mask and/or error are not given)</p></li>
<li><p><strong>plot_annulus</strong> (<em>bool, optional</em>) – Plot the annulus? (default True)</p></li>
<li><p><strong>plot_aperture</strong> (<em>bool, optional</em>) – Plot the aperture? (default True)</p></li>
<li><p><strong>ann_output</strong> (<em>str, optional</em>) – Name for output annulus plot (default None; set by function if
<cite>plot_annulus = True</cite>)</p></li>
<li><p><strong>ap_output</strong> (<em>str, optional</em>) – Name for output aperture plot (default None; set by function if
<cite>plot_aperture = True</cite>)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Write the resultant table? (default False)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for the output table file (default None; set by function if
<cite>write = True</cite>)</p></li>
<li><p><strong>cmap</strong> (<em>str, matplotlib.colors.ListedColormap, optional</em>) – Colormap for plots (default “bone”)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Table containing RA, Dec, calibrated magnitude, filter used, and
MJD for the limiting magnitude</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a given RA, Dec, finds the limiting magnitude at its location. If
a source was previously detected &lt;= 3” away from the given coords by
astrometry.net, the aperture will randomly move about until a valid
RA, Dec is found.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alala.apphotom.ellipse_photom">
<span class="sig-prename descclassname"><span class="pre">alala.apphotom.</span></span><span class="sig-name descname"><span class="pre">ellipse_photom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_sma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_pa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">60.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sma_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sma_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_sub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_annulus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_ellipses</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ann_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ell_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bone'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.apphotom.ellipse_photom" title="Permalink to this definition"></a></dt>
<dd><p>Like <a class="reference internal" href="#alala.apphotom.aperture_photom" title="alala.apphotom.aperture_photom"><code class="xref py py-func docutils literal notranslate"><span class="pre">aperture_photom()</span></code></a>, but use an elliptical aperture.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_file</strong> (<em>str</em>) – Filename for <strong>NOT background-subtracted</strong> image</p></li>
<li><p><strong>ra, dec</strong> (<em>float, list</em>) – Floats <strong>or</strong> lists of RA, Dec of interest</p></li>
<li><p><strong>mask</strong> (<em>np.ndarray, str, optional</em>) – Filename for a source mask <strong>or</strong> the mask data itself (default None;
in which case a source mask is made)</p></li>
<li><p><strong>guess_sma</strong> (<em>float, optional</em>) – Initial guess for semi-major of ellipse, in arcseconds (default 1.0)</p></li>
<li><p><strong>guess_eps</strong> (<em>float, optional</em>) – Initial guess for ellipticity (default 0.3)</p></li>
<li><p><strong>guess_pa</strong> (<em>float, optional</em>) – Initial guess for position angle of ellipse, in degrees (default 60.0)</p></li>
<li><p><strong>sma_min, sma_max</strong> (<em>float, optional</em>) – Minimum/maximum allowed semi-major axis of ellipse, in arcseconds
(default 0.2)</p></li>
<li><p><strong>r1, r2</strong> (<em>float, optional</em>) – Inner and outer radius of the annulus, in arcseconds (default 4.0”,
12.0”)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float, optional</em>) – Detection sigma to use in image segmentation (default 3.0)</p></li>
<li><p><strong>flux_sub</strong> (<em>float, optional</em>) – Additional flux to subtract, if, e.g., want to subtract the flux of
some galaxy (default 0)</p></li>
<li><p><strong>plot_annulus</strong> (<em>bool, optional</em>) – Plot the annulus? (default True)</p></li>
<li><p><strong>plot_ellipses</strong> (<em>bool, optional</em>) – Plot the elliptical isotophotes? (default True)</p></li>
<li><p><strong>ann_output</strong> (<em>str, optional</em>) – Name for output annulus plot (default None; set by function if
<cite>plot_annulus = True</cite>)</p></li>
<li><p><strong>ell_output</strong> (<em>str, optional</em>) – Name for output ellipses plot (default None; set by function if
<cite>plot_ellipses = True</cite>)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Write the resultant table? (default False)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for the output table file (default None; set by function if
<cite>write = True</cite>)</p></li>
<li><p><strong>cmap</strong> (<em>str, matplotlib.colors.ListedColormap, optional</em>) – Colormap for plots (default “bone”)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Table containing the results of “ellipse” photometry</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-alala.lightcurve">
<span id="alala-lightcurve-module"></span><h2>alala.lightcurve module<a class="headerlink" href="#module-alala.lightcurve" title="Permalink to this heading"></a></h2>
<p>Combine aperture and/or PSF photometry generated with <code class="xref py py-obj docutils literal notranslate"><span class="pre">apphotom</span></code> and/or
<code class="xref py py-obj docutils literal notranslate"><span class="pre">psfphotom</span></code> modules, to generate light curves.</p>
<p>Light curves can include 3 kinds of data points:</p>
<ol class="arabic simple">
<li><p>Magnitudes: Measured magnitudes, including error bars</p></li>
<li><p>Limiting magnitudes: Limiting magnitudes, which do not have error bars</p></li>
<li><p>Reference magnitudes: Reference magnitudes obtained from some other work /
analysis, with (optional) error barts</p></li>
</ol>
<dl class="py function">
<dt class="sig sig-object py" id="alala.lightcurve.plotting_to_agg">
<span class="sig-prename descclassname"><span class="pre">alala.lightcurve.</span></span><span class="sig-name descname"><span class="pre">plotting_to_agg</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#alala.lightcurve.plotting_to_agg" title="Permalink to this definition"></a></dt>
<dd><p>Switch matplotlib backend to ‘agg’</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alala.lightcurve.plotting_to_Qt4Agg">
<span class="sig-prename descclassname"><span class="pre">alala.lightcurve.</span></span><span class="sig-name descname"><span class="pre">plotting_to_Qt4Agg</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#alala.lightcurve.plotting_to_Qt4Agg" title="Permalink to this definition"></a></dt>
<dd><p>Switch matplotlib backend to ‘Qt4Agg’</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="alala.lightcurve.VALID_PHOT_FILTS">
<span class="sig-prename descclassname"><span class="pre">alala.lightcurve.</span></span><span class="sig-name descname"><span class="pre">VALID_PHOT_FILTS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['u',</span> <span class="pre">'g',</span> <span class="pre">'r',</span> <span class="pre">'i',</span> <span class="pre">'z',</span> <span class="pre">'Y',</span> <span class="pre">'J',</span> <span class="pre">'H',</span> <span class="pre">'K']</span></em><a class="headerlink" href="#alala.lightcurve.VALID_PHOT_FILTS" title="Permalink to this definition"></a></dt>
<dd><p>Valid photometric filters.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="alala.lightcurve.DEFAULT_PLOT_INSTRUCTIONS">
<span class="sig-prename descclassname"><span class="pre">alala.lightcurve.</span></span><span class="sig-name descname"><span class="pre">DEFAULT_PLOT_INSTRUCTIONS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'H':</span> <span class="pre">['#fac205',</span> <span class="pre">'s'],</span> <span class="pre">'J':</span> <span class="pre">['#029386',</span> <span class="pre">'s'],</span> <span class="pre">'K':</span> <span class="pre">['#c04e01',</span> <span class="pre">'s'],</span> <span class="pre">'Y':</span> <span class="pre">['#8e82fe',</span> <span class="pre">'s'],</span> <span class="pre">'g':</span> <span class="pre">['#0165fc',</span> <span class="pre">'o'],</span> <span class="pre">'i':</span> <span class="pre">['#ff9408',</span> <span class="pre">'o'],</span> <span class="pre">'r':</span> <span class="pre">['#00ffff',</span> <span class="pre">'o'],</span> <span class="pre">'u':</span> <span class="pre">['#be03fd',</span> <span class="pre">'o'],</span> <span class="pre">'z':</span> <span class="pre">['#ff474c',</span> <span class="pre">'o']}</span></em><a class="headerlink" href="#alala.lightcurve.DEFAULT_PLOT_INSTRUCTIONS" title="Permalink to this definition"></a></dt>
<dd><p>Default instructions for plotting magnitudes.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="alala.lightcurve.DEFAULT_PLOT_INSTRUCTIONS_LIM_MAGS">
<span class="sig-prename descclassname"><span class="pre">alala.lightcurve.</span></span><span class="sig-name descname"><span class="pre">DEFAULT_PLOT_INSTRUCTIONS_LIM_MAGS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'H':</span> <span class="pre">['#fac205',</span> <span class="pre">'v'],</span> <span class="pre">'J':</span> <span class="pre">['#ff028d',</span> <span class="pre">'v'],</span> <span class="pre">'K':</span> <span class="pre">['#c04e01',</span> <span class="pre">'v'],</span> <span class="pre">'Y':</span> <span class="pre">['#c65102',</span> <span class="pre">'v'],</span> <span class="pre">'g':</span> <span class="pre">['#0165fc',</span> <span class="pre">'v'],</span> <span class="pre">'i':</span> <span class="pre">['#ff9408',</span> <span class="pre">'v'],</span> <span class="pre">'r':</span> <span class="pre">['#00ffff',</span> <span class="pre">'v'],</span> <span class="pre">'u':</span> <span class="pre">['#be03fd',</span> <span class="pre">'v'],</span> <span class="pre">'z':</span> <span class="pre">['#ff474c',</span> <span class="pre">'v']}</span></em><a class="headerlink" href="#alala.lightcurve.DEFAULT_PLOT_INSTRUCTIONS_LIM_MAGS" title="Permalink to this definition"></a></dt>
<dd><p>Default instructions for plotting <strong>limiting</strong> magnitudes.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="alala.lightcurve.DEFAULT_PLOT_INSTRUCTIONS_REF_MAGS">
<span class="sig-prename descclassname"><span class="pre">alala.lightcurve.</span></span><span class="sig-name descname"><span class="pre">DEFAULT_PLOT_INSTRUCTIONS_REF_MAGS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'H':</span> <span class="pre">'#fac205',</span> <span class="pre">'J':</span> <span class="pre">'#ff028d',</span> <span class="pre">'K':</span> <span class="pre">'#c04e01',</span> <span class="pre">'Y':</span> <span class="pre">'#c65102',</span> <span class="pre">'g':</span> <span class="pre">'#0165fc',</span> <span class="pre">'i':</span> <span class="pre">'#ff9408',</span> <span class="pre">'r':</span> <span class="pre">'#00ffff',</span> <span class="pre">'u':</span> <span class="pre">'#be03fd',</span> <span class="pre">'z':</span> <span class="pre">'#ff474c'}</span></em><a class="headerlink" href="#alala.lightcurve.DEFAULT_PLOT_INSTRUCTIONS_REF_MAGS" title="Permalink to this definition"></a></dt>
<dd><p>Default instructions for plotting <strong>reference</strong> magnitudes.</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="alala.lightcurve.PLOT_INSTRUCTIONS_VIEIRA20">
<span class="sig-prename descclassname"><span class="pre">alala.lightcurve.</span></span><span class="sig-name descname"><span class="pre">PLOT_INSTRUCTIONS_VIEIRA20</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'g':</span> <span class="pre">['#76cd26',</span> <span class="pre">'s'],</span> <span class="pre">'i':</span> <span class="pre">['#0165fc',</span> <span class="pre">'o'],</span> <span class="pre">'z':</span> <span class="pre">['#ff474c',</span> <span class="pre">'D']}</span></em><a class="headerlink" href="#alala.lightcurve.PLOT_INSTRUCTIONS_VIEIRA20" title="Permalink to this definition"></a></dt>
<dd><p>Plotting instructions used in Vieira et al. (2020).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="alala.lightcurve.PLOT_INSTRUCTIONS_LIM_MAGS_VIEIRA20">
<span class="sig-prename descclassname"><span class="pre">alala.lightcurve.</span></span><span class="sig-name descname"><span class="pre">PLOT_INSTRUCTIONS_LIM_MAGS_VIEIRA20</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'g':</span> <span class="pre">['#76cd26',</span> <span class="pre">'v'],</span> <span class="pre">'i':</span> <span class="pre">['#0165fc',</span> <span class="pre">'v'],</span> <span class="pre">'z':</span> <span class="pre">['#ff474c',</span> <span class="pre">'v']}</span></em><a class="headerlink" href="#alala.lightcurve.PLOT_INSTRUCTIONS_LIM_MAGS_VIEIRA20" title="Permalink to this definition"></a></dt>
<dd><p>Plotting instructions for <strong>limiting magnitudes</strong> used in Vieira et al.
(2020).</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="alala.lightcurve.PLOT_INSTRUCTIONS_REF_MAGS_VIEIRA20">
<span class="sig-prename descclassname"><span class="pre">alala.lightcurve.</span></span><span class="sig-name descname"><span class="pre">PLOT_INSTRUCTIONS_REF_MAGS_VIEIRA20</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'g':</span> <span class="pre">'#76cd26',</span> <span class="pre">'i':</span> <span class="pre">'#0165fc',</span> <span class="pre">'z':</span> <span class="pre">'#ff474c'}</span></em><a class="headerlink" href="#alala.lightcurve.PLOT_INSTRUCTIONS_REF_MAGS_VIEIRA20" title="Permalink to this definition"></a></dt>
<dd><p>Plotting instructions for <strong>reference magnitudes</strong> used in Vieira et al.
(2020).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alala.lightcurve.fromfile">
<span class="sig-prename descclassname"><span class="pre">alala.lightcurve.</span></span><span class="sig-name descname"><span class="pre">fromfile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">readfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.lightcurve.fromfile" title="Permalink to this definition"></a></dt>
<dd><p>Read a single .fits table file containing either magnitudes or limiting
magnitudes</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>New <a class="reference internal" href="#alala.lightcurve.LightCurve" title="alala.lightcurve.LightCurve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LightCurve</span></code></a> object</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#alala.lightcurve.LightCurve" title="alala.lightcurve.LightCurve">LightCurve</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Does not work for reference magnitudes. Will assume magnitude is just
a regular magnitude. Reference magnitudes must be added one file at a time
(see <code class="xref py py-func docutils literal notranslate"><span class="pre">add_ref_files()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">add_ref_tables()</span></code>).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alala.lightcurve.fromdirectory">
<span class="sig-prename descclassname"><span class="pre">alala.lightcurve.</span></span><span class="sig-name descname"><span class="pre">fromdirectory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.lightcurve.fromdirectory" title="Permalink to this definition"></a></dt>
<dd><p>Search a directory for .fits files and read in magnitudes or limiting
magnitudes</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>New <a class="reference internal" href="#alala.lightcurve.LightCurve" title="alala.lightcurve.LightCurve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LightCurve</span></code></a> object</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#alala.lightcurve.LightCurve" title="alala.lightcurve.LightCurve">LightCurve</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Assumes that all files in the directory contain magnitudes or limiting
magnitudes. Reference magnitudes must be added one file at a time (see
<code class="xref py py-func docutils literal notranslate"><span class="pre">add_ref_files()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">add_ref_tables()</span></code>).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alala.lightcurve.frompoint">
<span class="sig-prename descclassname"><span class="pre">alala.lightcurve.</span></span><span class="sig-name descname"><span class="pre">frompoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mjd</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.lightcurve.frompoint" title="Permalink to this definition"></a></dt>
<dd><p>Generate a new light curve from a single specified data point</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – RA and Dec of the source of interest</p></li>
<li><p><strong>mag</strong> (<em>float</em>) – Magnitude</p></li>
<li><p><strong>mag_err</strong> (<em>float</em>) – Error on the magnitude</p></li>
<li><p><strong>filt</strong> (<em>str</em>) – Photometric filter used during observation</p></li>
<li><p><strong>mjd</strong> (<em>float</em>) – MJD at time of observation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New <a class="reference internal" href="#alala.lightcurve.LightCurve" title="alala.lightcurve.LightCurve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LightCurve</span></code></a> object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#alala.lightcurve.LightCurve" title="alala.lightcurve.LightCurve">LightCurve</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Should not be used for a limiting or reference magnitude.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">alala.lightcurve.</span></span><span class="sig-name descname"><span class="pre">LightCurve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mag_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lim_mag_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_mag_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.lightcurve.LightCurve" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#alala.lightcurve.LightCurve.copy" title="Permalink to this definition"></a></dt>
<dd><p>Return a (deep) copy of the object</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.mags">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mags</span></span><a class="headerlink" href="#alala.lightcurve.LightCurve.mags" title="Permalink to this definition"></a></dt>
<dd><p>Table of magnitudes</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.limmags">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">limmags</span></span><a class="headerlink" href="#alala.lightcurve.LightCurve.limmags" title="Permalink to this definition"></a></dt>
<dd><p>Table of <strong>limiting</strong> magnitudes</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.refmags">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">refmags</span></span><a class="headerlink" href="#alala.lightcurve.LightCurve.refmags" title="Permalink to this definition"></a></dt>
<dd><p>Table of <strong>reference</strong> magnitudes</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.plot_instructions">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plot_instructions</span></span><a class="headerlink" href="#alala.lightcurve.LightCurve.plot_instructions" title="Permalink to this definition"></a></dt>
<dd><p>Instructions for plotting magnitudes</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.plot_instructions_lim_mags">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plot_instructions_lim_mags</span></span><a class="headerlink" href="#alala.lightcurve.LightCurve.plot_instructions_lim_mags" title="Permalink to this definition"></a></dt>
<dd><p>Instructions for plotting <strong>limiting</strong> magnitudes</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.plot_instructions_ref_mags">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plot_instructions_ref_mags</span></span><a class="headerlink" href="#alala.lightcurve.LightCurve.plot_instructions_ref_mags" title="Permalink to this definition"></a></dt>
<dd><p>Instructions for plotting <strong>reference</strong> magnitudes</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.mag_colnames">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mag_colnames</span></span><a class="headerlink" href="#alala.lightcurve.LightCurve.mag_colnames" title="Permalink to this definition"></a></dt>
<dd><p>Columns to use as keys when searching for magnitudes in input
files/tables</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.limmag_colnames">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">limmag_colnames</span></span><a class="headerlink" href="#alala.lightcurve.LightCurve.limmag_colnames" title="Permalink to this definition"></a></dt>
<dd><p>Columns to use as keys when searching for <strong>limiting</strong> magnitudes
in input files/tables</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.add_tables">
<span class="sig-name descname"><span class="pre">add_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">tables</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.lightcurve.LightCurve.add_tables" title="Permalink to this definition"></a></dt>
<dd><p>Add one or more new tables to the existing LightCurve’s magnitude
table and/or limiting magnitude table</p>
<p class="rubric">Notes</p>
<p>Changes the <cite>LightCurve</cite> in place. Assumes that the tables contain
either magnitudes or limiting magnitudes. For adding in reference
magnitudes, see <a class="reference internal" href="#alala.lightcurve.LightCurve.add_ref_tables" title="alala.lightcurve.LightCurve.add_ref_tables"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_ref_tables()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.add_files">
<span class="sig-name descname"><span class="pre">add_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">files</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.lightcurve.LightCurve.add_files" title="Permalink to this definition"></a></dt>
<dd><p>Read in from files and then append any new tables to the existing
LightCurve’s magnitude table and/or limiting magnitude table</p>
<p class="rubric">Notes</p>
<p>Changes the <cite>LightCurve</cite> in place. Assumes that the files contain
tables with either magnitudes or limiting magnitudes. For adding in
reference magnitudes, see <a class="reference internal" href="#alala.lightcurve.LightCurve.add_ref_files" title="alala.lightcurve.LightCurve.add_ref_files"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_ref_files()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.add_ref_tables">
<span class="sig-name descname"><span class="pre">add_ref_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">tables</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.lightcurve.LightCurve.add_ref_tables" title="Permalink to this definition"></a></dt>
<dd><p>Same as <a class="reference internal" href="#alala.lightcurve.LightCurve.add_tables" title="alala.lightcurve.LightCurve.add_tables"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_tables()</span></code></a>, but for <strong>reference</strong> magnitudes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.add_ref_files">
<span class="sig-name descname"><span class="pre">add_ref_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">files</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.lightcurve.LightCurve.add_ref_files" title="Permalink to this definition"></a></dt>
<dd><p>Same as <a class="reference internal" href="#alala.lightcurve.LightCurve.add_files" title="alala.lightcurve.LightCurve.add_files"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_files()</span></code></a>, but for <strong>reference</strong> magnitudes</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.add_mag">
<span class="sig-name descname"><span class="pre">add_mag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mjd</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.lightcurve.LightCurve.add_mag" title="Permalink to this definition"></a></dt>
<dd><p>Manually add a single point to the light curve’s magnitude table</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – RA and Dec of the source of interest</p></li>
<li><p><strong>mag</strong> (<em>float</em>) – Magnitude</p></li>
<li><p><strong>mag_err</strong> (<em>float</em>) – Error on the magnitude</p></li>
<li><p><strong>filt</strong> (<em>str</em>) – Photometric filter used during observation</p></li>
<li><p><strong>mjd</strong> (<em>float</em>) – MJD at time of observation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.add_limmag">
<span class="sig-name descname"><span class="pre">add_limmag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mjd</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.lightcurve.LightCurve.add_limmag" title="Permalink to this definition"></a></dt>
<dd><p>Manually add a single point to the light curve’s <strong>limiting</strong>
magnitude table</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – RA and Dec of the source of interest</p></li>
<li><p><strong>mag</strong> (<em>float</em>) – <strong>Limiting</strong> magnitude</p></li>
<li><p><strong>filt</strong> (<em>str</em>) – Photometric filter used during observation</p></li>
<li><p><strong>mjd</strong> (<em>float</em>) – MJD at time of observation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.add_refmag">
<span class="sig-name descname"><span class="pre">add_refmag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mjd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_err</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.lightcurve.LightCurve.add_refmag" title="Permalink to this definition"></a></dt>
<dd><p>Manually add a single point to the light curve’s <strong>reference</strong>
magnitude table</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – RA and Dec of the source of interest</p></li>
<li><p><strong>mag</strong> (<em>float</em>) – <strong>Reference</strong> magnitude</p></li>
<li><p><strong>filt</strong> (<em>str</em>) – Photometric filter used during observation</p></li>
<li><p><strong>mjd</strong> (<em>float</em>) – MJD at time of observation</p></li>
<li><p><strong>mag_err</strong> (<em>float, optional</em>) – Error on the magnitude, if any (default None)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.coords_select">
<span class="sig-name descname"><span class="pre">coords_select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.lightcurve.LightCurve.coords_select" title="Permalink to this definition"></a></dt>
<dd><p>Given some light curve, select only data points for measurements
taken within <cite>sep</cite> arcseconds of RA <cite>ra</cite> and Dec <cite>dec</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – RA, Dec of the source of interest</p></li>
<li><p><strong>sep</strong> (<em>float, optional</em>) – Maximum allowed separation from the RA, Dec, in arcseconds
(default 1.0)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New <a class="reference internal" href="#alala.lightcurve.LightCurve" title="alala.lightcurve.LightCurve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LightCurve</span></code></a> object containing only sources satisfying
the condition</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#alala.lightcurve.LightCurve" title="alala.lightcurve.LightCurve">LightCurve</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Does <strong>NOT</strong> change the object in-place. Returns a new object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.set_plot_instructions">
<span class="sig-name descname"><span class="pre">set_plot_instructions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.lightcurve.LightCurve.set_plot_instructions" title="Permalink to this definition"></a></dt>
<dd><p>Set the plotting instructions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Name of .csv file containing plotting instructions</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The .csv should have no header, and should contain separate rows of
the form</p>
<blockquote>
<div><p>“u”,”red”,”o”</p>
<p>“g”,”#00ffff”,”s”</p>
<p>…</p>
</div></blockquote>
<p>Indicating the photometric filter, line/marker colour, and marker
style to use.</p>
<p>Will <strong>not</strong> change the marker style for limiting magnitudes, which
are fixed at “v” (downwards caret).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="alala.lightcurve.LightCurve.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">filters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lightcurve.png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmerger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connect</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limmag_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limmag_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refmag_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refmag_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.lightcurve.LightCurve.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot your light curve!</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*filters</strong> (<em>str, optional</em>) – Filter(s) of choice, if we wish to plot only the points for these
filters (default None; valid options in <code class="xref py py-obj docutils literal notranslate"><span class="pre">VALID_PHOT_FILTERS</span></code>)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Filename for output figure (default “lightcurve.png”; set to None
to save no figure)</p></li>
<li><p><strong>title</strong> (<em>str, optional</em>) – Title for the plot (default None)</p></li>
<li><p><strong>tmerger</strong> (<em>float, optional</em>) – Time of the merger, in MJD, to plot in time elapsed since merger
(default None –&gt; just plot MJD)</p></li>
<li><p><strong>show_legend</strong> (<em>bool, optional</em>) – Include a legend? (default True)</p></li>
<li><p><strong>connect</strong> (<em>bool, optional</em>) – Connect points of the same photometric filter with a line, for
legibility? (default True)</p></li>
<li><p><strong>text</strong> (<em>tuple, optional</em>) – Text to place in a text box, in the form (x, y, ‘text you want
printed’) (default None)</p></li>
<li><p><strong>mag_min, mag_max</strong> (<em>float, optional</em>) – Lower, upper limits on the magnitudes in the light curve; omit
datapoints outside bounds (default None)</p></li>
<li><p><strong>limmag_min, limmag_max</strong> (<em>float, optional</em>) – Lower, upper limits on the <strong>limiting</strong> magnitudes in the light
curve; omit datapoints outside bounds (default None)</p></li>
<li><p><strong>refmag_min, refmag_max</strong> (<em>float, optional</em>) – Lower, upper limits on the <strong>reference</strong> magnitudes in the light
curve; omit datapoints outside bounds (default None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Figure object, after all plotting</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.figure.Figure</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>“lower” and “upper” limits on the data points are understood in terms
of the magnitude system. I.e., m=26 is a lower limit, m=21 is an upper
limit.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-alala.psfphotom">
<span id="alala-psfphotom-module"></span><h2>alala.psfphotom module<a class="headerlink" href="#module-alala.psfphotom" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>CONTENTS:</dt><dd><ul class="simple">
<li><p><a class="reference internal" href="#alala.psfphotom.PSF_photometry" title="alala.psfphotom.PSF_photometry"><code class="xref py py-func docutils literal notranslate"><span class="pre">PSF_photometry()</span></code></a>: Get the effective Point Spread Function (ePSF) of
an image, fit all (or as many as desired) stars in the image with the
ePSF, get instrumental magnitudes, and then crossmatch with external
catalogue to get <strong>calibrated</strong> magnitudes</p></li>
<li><p><a class="reference internal" href="#alala.psfphotom.ePSF_FWHM" title="alala.psfphotom.ePSF_FWHM"><code class="xref py py-func docutils literal notranslate"><span class="pre">ePSF_FWHM()</span></code></a>: Get the full width at half-max (FWHM) of an ePSF</p></li>
<li><p><a class="reference internal" href="#alala.psfphotom.copy_zero_point" title="alala.psfphotom.copy_zero_point"><code class="xref py py-func docutils literal notranslate"><span class="pre">copy_zero_point()</span></code></a>: Copy zero point headers from one image to
another</p></li>
</ul>
</dd>
<dt>NON-STANDARD PYTHON DEPENDENCIES:</dt><dd><ul class="simple">
<li><p><cite>astropy</cite></p></li>
<li><p><cite>photutils</cite></p></li>
<li><p><cite>astroquery</cite></p></li>
</ul>
</dd>
<dt>NON-PYTHON DEPENDENCIES:</dt><dd><ul class="simple">
<li><p><cite>astrometry.net</cite></p></li>
</ul>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="alala.psfphotom.PSF_photometry">
<span class="sig-prename descclassname"><span class="pre">alala.psfphotom.</span></span><span class="sig-name descname"><span class="pre">PSF_photometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nstars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elongation_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrom_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_xy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsources</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_ePSF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ePSF_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_ePSF</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ePSF_plot_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_resids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resids_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_corr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_source_offs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_offs_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_field_offs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">field_offs_output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_blur_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.psfphotom.PSF_photometry" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_file</strong> (<em>str</em>) – Filename for <strong>background-subtracted</strong> image</p></li>
<li><p><strong>mask_file</strong> (<em>str, optional</em>) – Filename for a bad pixel mask (default None)</p></li>
<li><p><strong>nstars</strong> (<em>int, optional</em>) – Maximum number of stars to use in <strong>constructing</strong> the ePSF (default
40; set to None to impose no limit)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float, optional</em>) – Detection sigma to use in image segmentation (default 5.0)</p></li>
<li><p><strong>pixelmin</strong> (<em>int, optional</em>) – <em>Minimum</em> allowed number of pixels in isophotes to be used in
building the ePSF (default 20)</p></li>
<li><p><strong>elongation_lim</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed elongation of isophotes to used be in building the
ePSF (default 1.4)</p></li>
<li><p><strong>area_max</strong> (<em>float, optional</em>) – <em>Maximum</em> alllowed area for sources to be used in building the ePSF,
in square pixels (default 500)</p></li>
<li><p><strong>cutout</strong> (<em>int, optional</em>) – Size of cutout around each star, in pixels (default 35; <strong>must be
odd, will be rounded down if even</strong>)</p></li>
<li><p><strong>astrom_sigma</strong> (<em>float, optional</em>) – Sigma threshold for astrometry.net source detection image (default 5.0)</p></li>
<li><p><strong>psf_sigma</strong> (<em>float, optional</em>) – Sigma of the Gaussian PSF of the image to be used by
astrometry.net (default 5.0)</p></li>
<li><p><strong>alim</strong> (<em>int, optional</em>) – Maximum allowed source area, in pixels**2, beyond which sources will
be deblended in astrometry.net (default 10000)</p></li>
<li><p><strong>write_xy</strong> (<em>bool, optional</em>) – Keep the <cite>.xy.fits</cite> source list produced by astrometry.net? (default
False)</p></li>
<li><p><strong>nsources</strong> (<em>int, optional</em>) – Limit on number of sources to fit with ePSF for obtaining the zero
point (default None –&gt; impose no limit)</p></li>
<li><p><strong>cat_num</strong> (<em>str, optional</em>) – Vizier catalog number to determine which catalog to cross-match (
default None –&gt; set to PanStarrs 1, SDSS DR12, or 2MASS depending on
filter used during observations)</p></li>
<li><p><strong>sep_max</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed separation between sources when cross-matching to
catalog, in pixels (default 2.0 ~ 0.6 arcseconds for WIRCam, 0.37
arcseconds for MegaCam)</p></li>
<li><p><strong>write_ePSF</strong> (<em>bool, optional</em>) – Write the derived ePSF to a .fits file? (default False)</p></li>
<li><p><strong>output_ePSF</strong> (<em>str, optional</em>) – Filename for output ePSF fits file (default None –&gt; set by function)</p></li>
<li><p><strong>plot_ePSF</strong> (<em>bool, optional</em>) – Plot the ePSF? (default True)</p></li>
<li><p><strong>ePSF_plot_output</strong> (<em>str, optional</em>) – Filename for output ePSF plot (default None –&gt; set by function)</p></li>
<li><p><strong>plot_resids</strong> (<em>bool, optional</em>) – Plot the residuals of the iterative ePSF fitting? (default False)</p></li>
<li><p><strong>resids_output</strong> (<em>str, optional</em>) – Filename for output residuals plot (default None –&gt; set by function)</p></li>
<li><p><strong>plot_corr</strong> (<em>bool, optional</em>) – Plot the instrumental magnitude versus castalogue magnitude
correlation used to obtain the zero point (default False)</p></li>
<li><p><strong>corr_output</strong> (<em>str, optional</em>) – Filename for output correlation plot (default None –&gt; set by function)</p></li>
<li><p><strong>plot_source_offs</strong> (<em>bool, optional</em>) – Plot offsets between image WCS and catalog WCS (default False)</p></li>
<li><p><strong>source_offs_output</strong> (<em>str, optional</em>) – Filename for output source offsets plot (default None –&gt; set by
function)</p></li>
<li><p><strong>plot_field_offs</strong> (<em>bool, optional</em>) – Plot offsets across the field, with a Gaussian blur to visualize
large-scale structure in the offsets, if any</p></li>
<li><p><strong>field_offs_output</strong> (<em>str, optional</em>) – Filename for output field offsets plot (default None –&gt; set by
function)</p></li>
<li><p><strong>gaussian_blur_sigma</strong> (<em>float, optional</em>) – Sigma of the Gaussian blur to use in the field offsets plot, if
plotting (default 30.0)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Write the table of calibrated sources with PSF photometry to a file?
(default False)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output fits table of sources (default None –&gt; set by
function)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Table of all PSF-fit sources, with their calibrated magnitudes</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TYPE</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Using image segmentation, find as many sources as possible in the image
with some constraints on number of pixels, elongation, and area. Use these
sources to build an empirical effective PSF (ePSF). Use a list of sources
found by astrometry.net to fit the ePSF to all of those sources. Compute
the instrumental magnitude of all of these sources. Query the correct
online catalogue for the given filter to crossmatch sources in the image
with those in the catalogue (e.g., Pan-STARRS 1). Find the zero point
which satisfies AB_mag = ZP + instrumental_mag and gets the calibrated
AB mags for all PSF-fit sources.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alala.psfphotom.ePSF_FWHM">
<span class="sig-prename descclassname"><span class="pre">alala.psfphotom.</span></span><span class="sig-name descname"><span class="pre">ePSF_FWHM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsf_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.psfphotom.ePSF_FWHM" title="Permalink to this definition"></a></dt>
<dd><p>Obtain the full width at half-max (FWHM) of an ePSF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>epsf_data</strong> (<em>str, np.ndarray</em>) – Fits file containing ePSF data <strong>or</strong> the data array itself</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>FWHM of the ePSF</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="alala.psfphotom.copy_zero_point">
<span class="sig-prename descclassname"><span class="pre">alala.psfphotom.</span></span><span class="sig-name descname"><span class="pre">copy_zero_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#alala.psfphotom.copy_zero_point" title="Permalink to this definition"></a></dt>
<dd><p>Copy the zero point headers from <cite>source_file</cite> to <cite>target_file</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>zp_mean</strong> (<em>float</em>) – Zero points mean</p></li>
<li><p><strong>zp_med</strong> (<em>float</em>) – Zero points median</p></li>
<li><p><strong>zp_std</strong> (<em>float</em>) – Zero points standard deviation</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Copy the zero point obtained via PSF photometry from one fits header to
another. Useful when one uses a background-subtracted image to do <em>PSF
photometry</em>, obtains the zero point, and then wants to perform <em>aperture
photometry</em> on the original, unsubtracted image.</p>
</dd></dl>

</section>
<section id="alala-stack-module">
<h2>alala.stack module<a class="headerlink" href="#alala-stack-module" title="Permalink to this heading"></a></h2>
</section>
<section id="module-alala">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-alala" title="Permalink to this heading"></a></h2>
<p>Top-level package for alala.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="alala" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Nicholas Vieira.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>